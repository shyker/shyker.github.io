(self.modernJsonp=self.modernJsonp||[]).push([["19142"],{412442(e,t,r){r.r(t),r.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CSSCarouselModule_parentPin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{args:null,kind:"FragmentSpread",name:"ItemRep_parentPin"}],type:"Pin",abstractKey:null};n.hash="d1542775568248acbce5a79453f4dffb";let i=n},827932(e,t,r){var n,i;r.r(t),r.d(t,{default:()=>o});let a={argumentDefinitions:[{defaultValue:!0,kind:"LocalArgument",name:"skipUnauthFragment"}],kind:"Fragment",metadata:null,name:"CSSCarouselModule_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"location",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentIds",storageKey:null},{alias:null,args:null,concreteType:"StoryDisplayOptions",kind:"LinkedField",name:"displayOptions",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryContentDisplay",kind:"LinkedField",name:"contentDisplay",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryContentVisibleItemCount",kind:"LinkedField",name:"contentVisibleItemCount",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mobile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"web",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemWidthHeightRatio",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[i],storageKey:'images(spec:"236x")'},{args:[{kind:"Variable",name:"skipUnauthFragment",variableName:"skipUnauthFragment"}],kind:"FragmentSpread",name:"ItemRep_pin"}],type:"Pin",abstractKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{alias:"storyTitle",args:null,concreteType:"StoryText",kind:"LinkedField",name:"title",plural:!1,selections:[n],storageKey:null},{args:null,kind:"FragmentSpread",name:"ItemRep_story"},{args:null,kind:"FragmentSpread",name:"useCarouselModuleLogic_story"},{args:null,kind:"FragmentSpread",name:"HeaderModule_story"}],type:"Story",abstractKey:null};a.hash="dee347ef77ae345e076b08494d4b664f";let o=a},31737(e,t,r){r.d(t,{A:()=>v});var n,i,a=r(335831),o=r(657140);r(654798);var s=r(836737),l=r(129625),d=r(939359),c=r(900565),u=r(909901),p=r(237745),h=r(92760),m=r(799445),f=r(994341),g=r(491149),x=r(904396),y=r(135656);let _=(void 0!==n||(n=r(412442)).hash&&"d1542775568248acbce5a79453f4dffb"!==n.hash&&console.error("The definition of 'CSSCarouselModule_parentPin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),b=(void 0!==i||(i=r(827932)).hash&&"dee347ef77ae345e076b08494d4b664f"!==i.hash&&console.error("The definition of 'CSSCarouselModule_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function v({accessibilityLabelledBy:e,auxData:t,component:r,contentVisibleItemCountOverride:n,disableHeader:i,getProductTagAuxData:v,headerDisplayOptions:w,heading:A,itemRepSiblingNodeFactories:S,items:j,itemWidth:k,itemWidthHeightRatio:I,parentPinKey:P,renderItem:C,saveButtonOptions:T,showBorder:M,showMarkers:E=!1,showNavigationButtons:F=!0,storyKey:z,subtitle:H,surface:R,view:O=3,viewParameter:D,width:L}){(0,o.useEffect)(()=>{(0,a.A)("CSSCarouselModule","/app/packages/StructuredFeed/ModuleReps/CarouselModule/CSSCarouselModule.tsx")},[]);let{logContextEvent:N}=(0,l.o)(),U=(0,g.Ay)(),W=(0,g.bh)(U),B=(0,c.A)(_,P),K=(0,c.A)(b,z),V=K?.objects?[...K.objects]:[],$=V.map(e=>"Pin"===e.__typename?e.entityId:null),Y=(0,o.useMemo)(()=>{let e=K?.storyType?{story_type:K.storyType}:void 0;return e&&t?{...t,...e}:e??t},[K?.storyType,t]),J=W?236:175,q=k??J,G=K.displayOptions?.contentDisplay?.itemWidthHeightRatio??I??1,{web:X,mobile:Q}=K.displayOptions?.contentDisplay?.contentVisibleItemCount??{},Z=n??(W?X:Q),ee=!i&&(K?.storyTitle||A||H),{showModuleBorder:et,showExtraSmallSubtitle:er,headerMarginBottom:en,isFixedWidthSlides:ei,moduleBorderStyle:ea}=(0,m.A)({storyKey:K,styleOverrides:{showModuleBorder:M}}),eo=!ei&&!!Z&&!k,es=eo?"100%":q,el=(0,o.useCallback)(({currentIndex:e,nextIndex:t})=>{if(void 0===e||e===t)return;let n=Number($?.[e]);N({aux_data:Y,event_type:108,component:r,view_type:O,view_parameter:D,event_data:{pinCarouselSlotEventData:{carouselSlotId:Number.isFinite(n)?n:void 0,carouselSlotIndex:e,toCarouselSlotIndex:t}}})},[Y,r,$,N,O,D]),ed=(0,o.useCallback)(({item:e,index:t})=>{let n=()=>{let n;if(C)return C({item:e,index:t});if(t===V.length-1&&K.action?.text&&K.action?.url&&(n=K.action,n?.text&&n?.url&&h.$$.has(n?.location))){let t="Pin"===e.__typename&&e.images_236x?.url;return t&&(0,y.jsx)(u.A,{auxData:Y,buttonText:K.action?.text,component:r,contentIds:K.contentIds??void 0,element:179,imageWidth:es,previewImageSrc:t,storyId:K.storyId??"",storyType:K.storyType,url:K.action.url,view:O,viewParameter:D})}let i="Pin"===e.__typename?v?.(e):void 0;return(0,y.jsx)(p.A,{auxData:{...i,...Y},boardKey:null,component:r,imageWidth:es,isInDesktopCarousel:W,isInMobileCarousel:!W,item:null,itemWidthHeightRatio:G,parentPinKey:B,pinKey:"Pin"===e.__typename?e:null,productTagParentPinId:B?.entityId,relatedInterestKey:null,saveButtonOptions:T,slotIndex:t,storyKey:K,surface:R,view:O,viewParameter:D})},i=S?.[t];if(i){let e=n();return(0,y.jsx)(x.e,{children:t=>(0,y.jsx)(s.az,{position:"relative",children:(0,y.jsxs)(o.Fragment,{children:[e,i(t)]})})})}return n()},[V.length,r,v,W,S,es,G,Y,B,C,T,K,R,O,D]);return(0,y.jsxs)(s.az,{borderColor:et?"decorative":void 0,borderWidth:et?ea:void 0,dangerouslySetInlineStyle:{__style:{"--carousel-item-width":`${q}px`,"--story-item-width-height-ratio":`${1/G}`,...eo&&{"--carousel-item-count":`${Z}`}}},direction:"column",display:"flex",rounding:et?400:void 0,width:L??"100%",children:[ee&&(0,y.jsx)(s.az,{marginStart:6,marginTop:4,children:(0,y.jsx)(f.A,{auxData:Y,headerDisplayOptions:w,marginBottomOverride:en,showExtraSmallSubtitle:er,storyKey:K,view:O,viewParameter:D})}),(0,y.jsx)(s.az,{position:"relative",children:(0,y.jsx)(d.A,{accessibilityLabelledBy:e,items:j??V,mode:"multi",onIndexChange:el,renderItem:ed,showNavigationButtons:F,showScrollMarkers:E})})]})}},603909(e,t,r){r.d(t,{A:()=>p});var n=r(679902),i=r(76501),a=r(321571),o=r(421752),s=r(14143),l=r(892804),d=r(775816),c=r(315718),u=r(916244);let p=function(){let e=(0,i.A)();if(e?.isAuthenticated&&!function(){let e=(0,i.A)(),t=window.location.pathname.startsWith("/settings/notifications"),r=window.location.pathname.startsWith("/reports-and-violations/"),n=window.location.pathname.startsWith("/email/subscription")||window.location.pathname.startsWith("/email/remove")||t,a=window.location.pathname.startsWith("/pin/create/"),o="/pin-builder/"===window.location.pathname&&/url=/.test(window.location.href),{userAgent:s}=e||{userAgent:{isMobile:!1,isTablet:!1}};return s.isMobile||s.isTablet?n||r:a||o||n||r}()){var t,r;let i,p,{viewType:h,viewParameter:m}=(0,d.Cs)()??{},f=(0,c.uy)(window);t={data:{appVersion:(0,u.A)(),auxData:{pwa_type:f&&"unknown"!==f?f:void 0,stage:e.stage??"unknown"},browser:e.userAgent.browserType,clientUUID:(0,n.A)(),event_type:7137,time:1e6*Date.now(),unauth_id:e.unauthId,view_type:h,view_parameter:m}},r=e.isAuthenticated,i=a.A.create("ActiveUserResource",t),p=3e4,i.callCreate().catch(e=>{let n,a=e.message;if(a&&"object"==typeof a){"_t_message"in a&&delete a._t_message;try{n=JSON.stringify(a)}catch(e){n="Unable to serialize error message"}}else n=a;(0,l.GV)("webapp.metrics.dau.errors",{sampleRate:1,tags:{message:n,browser:t.data.browser,error_code:(0,s.A)(e,"api_error_code")||"unknown",is_auth:r}}),setTimeout(()=>{p>o.Qv||(p*=2,i.callCreate())},p)})}}},212178(e,t,r){function n(e){return[0,24,21,26].includes(e)}function i({articleType:e,id:t,title:r}){let n=r.toLowerCase().replace(/[.,\/#!?$%\^&\*+;:{}=\-_`~()\’'"]/g,"").trim().replace(/\s+/g,"-");return"today"===e?`/today/shop/${n}/${t}/`:`/discover/article/${n}/${t}/`}r.d(t,{I:()=>n,k:()=>i})},437750(e,t,r){r.d(t,{E2:()=>n,I0:()=>l,KU:()=>p,N9:()=>a,Rv:()=>o,X9:()=>i,Yl:()=>u,hh:()=>d,t8:()=>s});let n=e=>{let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t&&[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]},i=(e,t,r)=>.2126*(e/255)**2.2+.7151*(t/255)**2.2+.0721*(r/255)**2.2,a=e=>{let t=e.replace("#","");return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<155},o=({hexColor:e,saturationMultiplier:t,brightnessMultiplier:r,minSaturationClamp:i,mixVal:a=1,minBrightnessClamp:o=0})=>{let s=n(e);null===s&&(s=[229,229,224]);let l=((e,t,r)=>{let n=Math.max(e/=255,t/=255,r/=255),i=n-Math.min(e,t,r),a=0;return 0!==i&&(a=(n===e?(t-r)/i+6*(t<r):n===t?(r-e)/i+2:(e-t)/i+4)*60)<0&&(a+=360),{h:a,s:0===n?0:i/n,b:n}})(...s),d=(e,t,r)=>Math.max(t,Math.min(e,r));l.s=d(l.s*(1+t),i,1),l.b=d(l.b*(1+r),o,1);let c=(({h:e,s:t,b:r})=>{let n=r*t,i=n*(1-Math.abs(e/60%2-1)),a=r-n,o=0,s=0,l=0;return e<60?(o=n,s=i):e<120?(o=i,s=n):e<180?(s=n,l=i):e<240?(s=i,l=n):e<300?(o=i,l=n):(o=n,l=i),{r:Math.round((o+a)*255),g:Math.round((s+a)*255),b:Math.round((l+a)*255)}})({...l}),u=e=>({r:Math.round(c.r*a+e*(1-a)),g:Math.round(c.g*a+e*(1-a)),b:Math.round(c.b*a+e*(1-a))}),p=u(0),h=u(255);return[[p.r,p.g,p.b],[h.r,h.g,h.b]]};function s(e){if("string"!=typeof e)return{r:0,g:0,b:0,a:0};let t=e.trim(),r="rgba"===t.slice(0,4).toLowerCase(),n=!r&&"rgb"===t.slice(0,3).toLowerCase();if(!r&&!n)return{r:0,g:0,b:0,a:0};let i=t.indexOf("("),a=t.indexOf(")",i);if(-1===i||-1===a)return{r:0,g:0,b:0,a:0};let o=t.slice(i+1,a).split(",").map(e=>e.trim());if(r&&4!==o.length||n&&3!==o.length)return{r:0,g:0,b:0,a:0};let[s,l,d,c]=o,u=Number(s),p=Number(l),h=Number(d),m=r?Number(c):1;return[u,p,h].some(e=>Number.isNaN(e))||r&&Number.isNaN(m)?{r:0,g:0,b:0,a:0}:{r:u,g:p,b:h,a:m}}function l(e,t){let r=e.a+t.a*(1-e.a);return 0===r?{r:0,g:0,b:0,a:0}:{r:Math.round((e.r*e.a+t.r*t.a*(1-e.a))/r),g:Math.round((e.g*e.a+t.g*t.a*(1-e.a))/r),b:Math.round((e.b*e.a+t.b*t.a*(1-e.a))/r),a:r}}let d=e=>`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`,c=e=>e.toString(16).padStart(2,"0"),u=(e,t)=>{let r=n(e);if(!r)throw Error(`Invalid hex color: ${e} for lightenHexByPercentage`);let[i,a,o]=r,s=Math.max(0,Math.min(100,t))/100,l=Math.round(i+(255-i)*s),d=Math.round(a+(255-a)*s),u=Math.round(o+(255-o)*s);return`#${c(l)}${c(d)}${c(u)}`},p=(e,t)=>d(((e,t)=>{let r=n(e);if(!r)throw Error(`Invalid hex color: ${e} for hexToRgba`);let[i,a,o]=r;return{r:i,g:a,b:o,a:Math.max(0,Math.min(1,t))}})(e,t))},33396(e,t,r){r.d(t,{A:()=>h});var n=r(335831),i=r(657140),a=r(836737),o=r(254762),s=r(625277),l=r(259628);let d="0px 0px 8px rgba(0, 0, 0, 0.1)";var c=r(376195),u=r(297178),p=r(135656);function h({children:e,footerConfig:t,headerConfig:r,height:h,hideOnScroll:m,hideOnScrollState:{isHidden:f,updateHiddenState:g},isFooterHidden:x,noPadding:y,paddingX:_,paddingY:b=3,type:v,zIndex:w,isStoryPin:A}){let S,j;(0,i.useEffect)(()=>{(0,n.A)("FixedContent","/app/packages/layout/FixedContent.tsx")},[]);let{headerLimitedOverflow:k,ignoreObstructions:I,zIndexForGestaltBug:P}=r||{},{appUpsellFooterConfig:C,footerInLego:T,navFooterConfig:M}=t||{},E=!!C,F="header"===v?"top":"bottom",{isDarkMode:z}=(0,s.D2)(),{isRTL:H}=(0,c._8)(),{mWebCloseupRedesignEnabled:R}=(0,o.A)(),O=(0,i.useRef)(null),D=(0,i.useRef)(null);(0,i.useEffect)(()=>{try{if(!I){let e=O.current;D.current=k&&e&&Array.isArray(e.children)?e.children[0]:e,D.current instanceof HTMLElement&&l.A.addObstruction(F,D.current)}}catch(e){window.console.error(e),window.console.error('Can only register impression obstructions for type "HTMLElement"')}return()=>{!I&&D.current instanceof HTMLElement&&l.A.removeObstruction(F,D.current)}},[I,k,F,z]);let L="top"===F?"relative":"fixed",N=y?0:b,U=(h??64)+(r?.overrideTop||0),W=m||M?{transition:T||R?"transform 300ms ease-in-out, opacity 300ms ease-in-out":"transform 200ms linear",...f||x?{transform:`translateY(${"top"===F?-U:U}px)`,opacity:T||R?0:1}:Object.freeze({})}:{},B=2*!("relative"!==L||r?.noGutter),K=B?-B:0,V=z?s.ee:"rgba(255,255,255,.95)";z&&("header"===v?S=-1:j=-1);let $=T?E?void 0:h??64:"100%",Y=r?.isTranslucent&&V||z?V:"var(--sema-color-background-default)",J=r?.isTransparentBackground&&1?"var(--sema-color-background-transparent)":Y,q=(0,i.useMemo)(()=>({height:"footer"===v&&R?`calc(${$} + env(safe-area-inset-bottom))`:$,...R&&"footer"===v?{paddingBottom:`calc(env(safe-area-inset-bottom) + ${4*(N||0)}px)`}:Object.freeze({})}),[R,$,v,N]),G=(0,u.A)({skipExpActivation:!0});return(0,p.jsx)(a.az,{ref:O,bottom:"footer"===v,dangerouslySetInlineStyle:{__style:{top:S,bottomStyle:j,...!w||P?{zIndex:P||1}:Object.freeze({}),...k?{background:"transparent",overflow:"hidden",paddingBottom:100,marginBottom:-100,pointerEvents:"none"}:Object.freeze({}),...r?.hasBorder?{borderBottom:"1px solid #efefef"}:Object.freeze({}),...t?.hasTopShadow?{boxShadow:"0 -2px 4px 1px rgba(0, 0, 0, 0.08)"}:Object.freeze({}),...W}},"data-test-id":v,display:E?"flex":void 0,height:h&&!T?h:void 0,left:!0,marginEnd:T?"auto":K,marginStart:T?"auto":K,onTransitionEnd:()=>{(m||M)&&D.current&&(f||x?l.A.removeObstruction(F,D.current):l.A.addObstruction(F,D.current))},position:L,right:!0,top:"header"===v,width:T||"fixed"!==L?void 0:"100%",zIndex:P?void 0:w,children:(0,p.jsx)(a.az,{alignItems:t?.alignCenter?"center":void 0,dangerouslySetInlineStyle:{__style:{backgroundColor:J,paddingLeft:H||!G||A?void 0:"8px",paddingRight:H&&G&&!A?"8px":void 0,...q,boxShadow:R&&"footer"===v?`0 10px 0 0 ${J}, ${d}`:T?d:void 0,marginBottom:T&&!M?.docked?16:void 0,...k?{pointerEvents:"auto"}:Object.freeze({}),...r?.useRoundedCorners?{zIndex:5,borderTopRightRadius:17,borderTopLeftRadius:17,borderBottomRightRadius:0,borderBottomLeftRadius:0}:Object.freeze({})}},display:T||t?.alignCenter?"flex":void 0,marginEnd:T?"auto":void 0,marginStart:T?"auto":void 0,paddingX:_||4*("footer"===v&&!y)+B,paddingY:N,position:"relative",rounding:T&&!M?.docked?"pill":void 0,width:M?M.footerWidth:E?void 0:"100%",children:"function"==typeof e?e({updateHiddenState:g}):e})})}},97816(e,t,r){r.r(t),r.d(t,{default:()=>d});var n=r(335831),i=r(657140),a=r(836737),o=r(33396),s=r(447341),l=r(135656);function d({hasBorder:e,headerLimitedOverflow:t,ignoreObstructions:r,isTranslucent:d,isTransparentBackground:c,noGutter:u,overrideTop:p,useRoundedCorners:h,zIndexForGestaltBug:m,isStoryPin:f,...g}){(0,i.useEffect)(()=>{(0,n.A)("FixedHeader","/app/packages/layout/FixedHeader.tsx")},[]);let{noPadding:x,paddingY:y=3,zIndex:_}=g;return(0,l.jsx)(a.ib,{height:t?44+2*(x?0:y)*4:void 0,top:p||0,zIndex:_||void 0,children:(0,l.jsx)(s.A,{hideOnScroll:g.hideOnScroll,children:n=>(0,l.jsx)(o.A,{...g,headerConfig:{isTranslucent:d,isTransparentBackground:c,headerLimitedOverflow:t,hasBorder:e,ignoreObstructions:r,noGutter:u,overrideTop:p,zIndexForGestaltBug:m,useRoundedCorners:h},hideOnScrollState:n,isStoryPin:f,type:"header"})})})}},447341(e,t,r){r.d(t,{A:()=>o});var n=r(657140),i=r(835122);function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o extends n.Component{constructor(...e){super(...e),a(this,"state",{isHidden:!!this.props.appUpsellFooterConfig||!!this.props.navFooterConfig?.isDockedNavOnPlp}),a(this,"lastScrollPos",0),a(this,"updateHiddenState",e=>{this.reqAnimationId=window.requestAnimationFrame(()=>{this.setState({isHidden:e})})}),a(this,"handleScroll",(0,i.A)(()=>{let{appUpsellFooterConfig:e,navFooterConfig:t}=this.props,{isHidden:r}=this.state,n=window.scrollY,i=n-this.lastScrollPos,a="none",{scrollHeight:o,clientHeight:s}=document.documentElement||{};Number.isNaN(o)||Number.isNaN(s)||(a=i<0?n<=Math.abs((window.scrollMinY||0)+Math.max(i,20))?"start":"none":n>=(window.scrollMaxY||o-s)-Math.max(i,20)?"end":"none");let l=55*!t?.isModal;e?i>20&&r&&n>=500?e.shouldShowAfterScroll()&&(this.updateHiddenState(!1),t?.onScroll(!1)):(i<-20&&!r||n<=l)&&(this.updateHiddenState(!0),t?.onScroll(!0)):this.props.navFooterConfig?.isDockedNavOnPlp?"start"===a&&!r||n<=l?(this.updateHiddenState(!0),t?.onScroll(!0)):(n>l||"end"===a)&&r&&(this.updateHiddenState(!1),t?.onScroll(!1)):(i<-20||"start"===a)&&r||n<=l?(this.updateHiddenState(!1),t?.onScroll(!1)):(i>20||"end"===a)&&!r&&(this.updateHiddenState(!0),t?.onScroll(!0)),this.lastScrollPos=n},30))}componentDidMount(){try{(this.props.hideOnScroll||this.props.navFooterConfig?.isDockedNavOnPlp)&&window.addEventListener("scroll",this.handleScroll)}catch(e){window.console.error(e),window.console.error('Can only register impression obstructions for type "HTMLElement"')}}componentWillUnmount(){(this.props.hideOnScroll||this.props.navFooterConfig?.isDockedNavOnPlp)&&window.removeEventListener("scroll",this.handleScroll),this.reqAnimationId&&(window.cancelAnimationFrame(this.reqAnimationId),this.reqAnimationId=null)}componentDidUpdate(e){!e.hideOnScroll&&this.props.hideOnScroll||!e.navFooterConfig?.isDockedNavOnPlp&&this.props.navFooterConfig?.isDockedNavOnPlp?(this.updateHiddenState(!0),window.addEventListener("scroll",this.handleScroll)):(e.hideOnScroll&&!this.props.hideOnScroll||e.navFooterConfig?.isDockedNavOnPlp&&!this.props.navFooterConfig?.isDockedNavOnPlp)&&(this.updateHiddenState(!1),window.removeEventListener("scroll",this.handleScroll))}render(){let{children:e,navFooterConfig:t}=this.props,{isHidden:r}=this.state;return e({isHidden:!t?.forceShow&&r,updateHiddenState:this.updateHiddenState})}}},299437(e,t,r){r.d(t,{A:()=>n});function n(e,t){return t in e}},573319(e,t,r){r.d(t,{A:()=>n});function n(e){let t;if(!e)return null;let r=e?.url;return Array.isArray(e?.params)?t=e?.params:Object.entries(t={...e?.params??{}}).forEach(([e,n])=>{r?.includes(`{${e}}`)&&(r=r?.replaceAll(`{${e}}`,String(n)),delete t[e])}),{name:"ApiResource",options:{url:r,data:t,...e?.method==="POST"?{postInsteadOfGet:!0}:{}},enabledRouteRefresh:e?.enabledRouteRefresh,headers:e?.headers,noCache:e?.noCache,schema:e?.schema}}},246509(e,t,r){r.d(t,{A:()=>a});var n=r(573319),i=r(508765);function a(e){return(0,i.A)((0,n.A)(e))}},645176(e,t,r){r.d(t,{A:()=>d});var n=r(657140),i=r(924660),a=r(810972),o=r(477040),s=r(247909);let l=(e,t,r)=>e.resources[t]?.[r];function d(e){let{name:t,optionsKey:r}=e??{name:"",optionsKey:""},d=t===o.W,c=(0,s.uN)(),u=c?.get(t,r);if(u)throw u;let p=(0,a.createSelector)(e=>l(e,t,r),e=>e?.data),h=(0,a.createSelector)(e=>l(e,t,r),e=>e?.auxData),m=(0,a.createSelector)(e=>l(e,t,r),e=>e?.error),f=(0,a.createSelector)(e=>l(e,t,r),e=>e?.nextBookmark),g=(0,i.d4)(f),x=(0,i.d4)(p),y=(0,i.d4)(h),_=(0,i.d4)(m),b=(0,n.useRef)({auxData:void 0,data:void 0,error:void 0,isAtEnd:!1,nextBookmark:void 0});if(d)return b.current;let v={auxData:y,data:x,error:_,isAtEnd:"-end-"===g,nextBookmark:g};return(v.auxData!==b.current.auxData||v.data!==b.current.data||v.error!==b.current.error||v.isAtEnd!==b.current.isAtEnd||v.nextBookmark!==b.current.nextBookmark)&&(b.current=v),b.current}},588275(e,t,r){r.d(t,{A:()=>a});var n=r(14143),i=r(798923);function a(){let e=navigator.serviceWorker;return e&&e.getRegistration?((0,i.PM)("mweb_service_worker.unregister_attempt"),e.getRegistration().then(e=>{if(e)return e.unregister().then(()=>((0,i.PM)("mweb_service_worker.unregister_success"),navigator.serviceWorker&&window.caches?window.caches.keys().then(e=>{let t=e.find(e=>e.startsWith("workbox-precaching"));return t?window.caches.delete(t):null}).then(()=>(0,i.PM)("mweb_service_worker.clear_app_shell")):Promise.resolve())).catch(e=>{(0,i.fu)("mweb_service_worker.unregister_fail",{error:(0,n.A)(e,"message")})})})):Promise.resolve()}},994308(e,t,r){r.d(t,{A:()=>n});function n(e){switch(e){case -1:return null;case 0:return"shopping-bag";case 1:return"tag";case 9:return"clock-history";default:return"magnifying-glass"}}},20273(e,t,r){r.d(t,{A:()=>n});function n({top:e,right:t,bottom:r,left:n,windowHeight:i,windowWidth:a,threshold:o=0}){return e>=0+o&&n>=0+o&&r<=i-o&&t<=a-o}},352469(e,t,r){r.d(t,{P:()=>n,y:()=>i});let{Provider:n,getMaybe:i}=(0,r(767216).A)("PinCreateDeleteContext")},45511(e,t,r){r.d(t,{A:()=>eK});var n=r(335831),i=r(657140),a=r(924660),o=r(278461),s=r(836737),l=r(221718),d=r(603909),c=r(731634),u=r(746743),p=r(135455),h=r(129625),m=r(93048),f=r(757507),g=r(183994),x=r(921831),y=r(625277);let _={borderRadius:"32px 32px 0px 0px",bottom:0,left:0,overflow:"hidden",touchAction:"none",boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",zIndex:1,width:"100vw",maxHeight:"100vw",minHeight:"30vh"},b={full:"100vh",default:"50vh",auto:""},v=({size:e,isDarkMode:t})=>(_.height=b[e],_.maxHeight="auto"===e?"90vh":"100vw",_.backgroundColor=t?y.be:"#FFFFFF",_);var w=r(306869),A=r(396901),S=r(498395),j=r(257470),k=r(135656);let I=({content:e,footer:t,header:r})=>{let[n,a]=(0,i.useState)(!1),o=(0,i.useRef)(null),l=(0,i.useCallback)(()=>{let e=o.current;e&&a(e?.clientHeight<e?.scrollHeight&&e.offsetHeight+e.scrollTop<e.scrollHeight)},[]);return(0,i.useEffect)(()=>{l()},[l]),(0,i.useEffect)(()=>(window?.addEventListener("resize",l),()=>{window?.removeEventListener("resize",l)}),[l]),(0,k.jsxs)(i.Fragment,{children:[(0,k.jsxs)(s.az,{ref:o,fit:!0,onScroll:l,overflow:"scroll",padding:0,children:[r,(0,k.jsx)(s.az,{flex:"grow",overflow:"auto",children:e})]}),!!t&&(0,k.jsx)(s.az,{dangerouslySetInlineStyle:n?{__style:{boxShadow:"var(--sema-space-0) var(--sema-space-negative-50) var(--sema-space-200) var(--sema-space-0) rgb(0 0 0 / 0.12)"}}:void 0,fit:!0,position:"relative",children:t})]})};function P({accessibilityModalLabel:e,allowClickAndDrag:t,allowBackgroundScroll:r=!1,children:a,closeOnOutsideClick:o=!0,footer:l,header:d,isOpen:c,mobileIsSlideUp:u,onDismiss:p,zIndex:h,size:m="auto"}){(0,i.useEffect)(()=>{(0,n.A)("SheetMobileWithMediaHeader","/app/packages/experiences/gestalt/SheetMobile/SheetMobileWithMediaHeader.tsx")},[]);let f=(0,A.A)(),g=(0,i.useRef)(null),{setAppFocusState:_}=(0,j.Y)(),[P,C]=(0,i.useState)(!1),{isDarkMode:T}=(0,y.D2)();if((0,i.useEffect)(()=>(c?_(!1):_(!0),()=>{c&&_(!0)}),[_,c]),(0,i.useEffect)(()=>(g.current=(0,x.A)(()=>{g.current&&C(!0)}),()=>{"u">typeof window&&Object.prototype.hasOwnProperty.call(window,"cancelAnimationFrame")&&g.current&&(window.cancelAnimationFrame(g.current),g.current=null)}),[]),(0,i.useEffect)(()=>{let e=c&&!r;return e&&(()=>{if(document.body){let{body:{style:e}}=document;e.overflow="hidden",e.touchAction="none"}})(),()=>{e&&(()=>{if(document.body){let{body:{style:e}}=document;e.overflow="visible",e.touchAction="auto"}})()}},[c,r]),!c)return null;let M=(({isDarkMode:e,size:t})=>{let r=e?y.be:"#FFFFFF";return{__style:{...v({size:t,isDarkMode:e}),backgroundColor:r,transitionProperty:"transform, opacity",transitionTimingFunction:"ease-out"}}})({isDarkMode:T,size:m});M.__style.transform=(()=>{if(u||!(()=>{if("u"<typeof window)return!1;let e=Math.max(window.visualViewport?.width||0,window.innerWidth,document.documentElement.clientWidth),t=Math.max(window.visualViewport?.height||0,window.innerHeight,document.documentElement.clientHeight);return e<=380||t<=760})())return"";let e=Math.min(1,(Math.max(window.visualViewport?.width||0,window.innerWidth,document.documentElement.clientWidth)-12)/380,(Math.max(window.visualViewport?.height||0,window.innerHeight,document.documentElement.clientHeight)-12)/600);return e=Math.max(.8,e),` scale(${e})`})();let E=(({size:e,isShowing:t,isDarkMode:r})=>{let n=v({size:e,isDarkMode:r});return n.transition="all 225ms cubic-bezier(0.0,0.0,0.2,1) 500ms",n.transform=t?"translateY(0)":`translateY(${b[e]||"100vh"})`,{__style:n}})({size:m,isShowing:P,isDarkMode:T});return(0,k.jsx)(S.A,{allowClickAndDrag:t,children:(0,k.jsx)(s.Wd,{children:(0,k.jsxs)(s.az,{"aria-label":e,display:"inlineBlock",height:"100%",position:"relative",role:"dialog",zIndex:h||w.QN,children:[(0,k.jsx)(s.Rp,{accessibilityLabel:f.bt("移动端页面遮罩层", "Mobile Sheet Mask", "mweb.sheet_mobile.mask", undefined, true),onTap:()=>{o&&p()},tapStyle:"none",children:(0,k.jsx)(s.az,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, .5)",touchAction:"none",transitionProperty:"opacity",transitionTimingFunction:"ease-out"}},height:"100%",left:!0,position:"fixed",top:!0,width:"100%",zIndex:new s.rk(1)})}),(0,k.jsx)(s.az,{color:"default",dangerouslySetInlineStyle:u?E:M,position:"fixed",children:(0,k.jsx)(s.az,{direction:"column",display:"flex",justifyContent:"between",maxHeight:E.__style?.maxHeight||"100vh",position:"relative",width:"100%",children:(0,k.jsx)(I,{content:a,footer:l,header:d})})})]})})})}var C=r(892804);let T=({display_data:e,complete:t,dismiss:r,context_aux_data:n})=>{let a=(0,A.A)(),{logContextEvent:o}=(0,h.o)(),[l,d]=(0,i.useState)(!0),[c,u]=(0,i.useState)(0),p=()=>{d(!1),r()},x=(0,i.useCallback)((e,t)=>{o({event_type:e,component:15489,element:t,aux_data:{experience_id:n.experience_id,placement_id:n.placement_id,step_number:c+1,step_index:c}})},[n.experience_id,n.placement_id,c,o]);if((0,i.useEffect)(()=>{x(13,18257)},[c,x]),!l)return null;if(!(e.steps&&e.steps.length>0&&e.steps.every(e=>e.title&&e.subtitle&&e.primary_button&&e.image)))return(0,C.GV)(m.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:"Required display data not present",platform:4}}),null;let y=e.steps[c];if(!y)return(0,C.GV)(m.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:`No step for index ${c}`,platform:4}}),null;let _=window?.innerWidth||375,b=(0,k.jsxs)(i.Fragment,{children:[(0,k.jsx)(s.ib,{top:0,children:(0,k.jsx)(s.az,{padding:3,position:"absolute",width:"100%",children:(0,k.jsx)(s.K0,{accessibilityLabel:a.bt("关闭", "Dismiss", "experiences.ExperienceModalWindow.modalDismissIconButton", undefined, true),bgColor:"washLight",icon:"close",iconColor:"default",onClick:()=>{x(123,75),p()},size:"lg"})})}),(0,k.jsx)(s.iX,{contentAspectRatio:.8,height:1.25*_,width:_,children:(0,k.jsx)(s._V,{alt:y.image.image_alt,color:y.image.dominant_color||void 0,fit:"cover",naturalHeight:y.image.height,naturalWidth:y.image.width,src:y.image.url})})]}),v=(0,k.jsxs)(s.az,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"center",paddingX:2,paddingY:3,children:[y.secondary_button&&(0,k.jsx)(f.A,{buttonType:"secondary",data:(0,g.q)(y.secondary_button,()=>{x(102,13005),p()}),experienceSchema:2}),(0,k.jsx)(f.A,{buttonType:"primary",data:(0,g.q)(y.primary_button,()=>{c<e.steps.length-1?(x(102,13004),u(c+1)):t()}),experienceSchema:2})]});return(0,k.jsx)(P,{accessibilityModalLabel:a.bt("多步骤模式", "Multi Step Modal", "experiences.ExperienceMultiStepModal.accessibilityModalLabel", undefined, true),allowClickAndDrag:!1,footer:v,header:b,isOpen:l,mobileIsSlideUp:!0,onDismiss:()=>{x(123,16412),p()},size:"auto",children:(0,k.jsxs)(s.az,{padding:3,children:[(0,k.jsx)(s.az,{marginBottom:3,children:(0,k.jsx)(s._Y,{size:"500",children:y.title})}),(0,k.jsx)(s.KJ,{children:y.subtitle})]})})};function M({experience:e}){return(0,i.useEffect)(()=>{(0,n.A)("ExperienceMultiStepModal","/app/packages/experiences/Experiences/ExperienceMultiStepModal/ExperienceMultiStepModal.tsx")},[]),(0,k.jsx)(u.Je,{eligibleSchemas:[2],eligibleTypes:[26],experience:e,children:({complete:t,dismiss:r,experience:{display_data:n}})=>(0,k.jsx)(T,{complete:t,context_aux_data:{experience_id:e?.experience_id,placement_id:e?.placement_id},dismiss:r,display_data:n})})}var E=r(620044),F=r(367943),z=r(388364),H=r(47998),R=r(97816),O=r(128353),D=r(742746),L=r(528989),N=r(376195),U=r(508765),W=r(220527),B=r(758778),K=r(424120),V=r(699415),$=r(906494),Y=r(218781),J=r(491149),q=r(911499),G=r(383218),X=r(308327),Q=r(612264),Z=r(239e3);r(273556);var ee=r(321173),et=r(233944),er=r(835122),en=r(119795),ei=r(20273),ea=r(131661);let eo={__style:{textOverflow:"ellipsis",whiteSpace:"nowrap"}};function es({currentTabIndex:e,tabBoards:t}){(0,i.useEffect)(()=>{(0,n.A)("MoreIdeasTabs","/app/www/Homefeed/MoreIdeasTabs.tsx")},[]);let r=(0,i.useRef)(null),l=(0,i.useRef)(!1),{width:d,height:c}=(0,ee.A)()||{width:0,height:0},u=(0,i.useRef)([]),p=(0,o.Zp)(),h=(0,A.A)(),m=(0,et.A)(),f=(0,a.wA)(),g=t.length?[{href:"/",text:(0,k.jsx)(s.az,{children:h.bt("所有", "All", "homefeed.moreIdeasTab.homefeedTab", undefined, true)}),tabType:1},...t.filter(e=>e).map(({id:e,name:t},r)=>({href:`/?boardId=${String(e)}`,text:(0,k.jsx)(s.az,{dangerouslySetInlineStyle:eo,maxWidth:100,overflow:"hidden",children:t}),boardId:e,tabType:2,ref:u.current[r]}))]:null,x=e=>1===e?11081:11082,y=(0,i.useRef)([]),_=(0,i.useCallback)(()=>{u&&u.current&&u.current.length&&u.current.forEach((e,r)=>{if(!e?.current)return;let{id:n,name:i}=t[r]||{},a=e.current.getBoundingClientRect();(0,ei.A)({left:a.left,right:a.right,top:a.top,bottom:a.bottom,windowHeight:c,windowWidth:d})&&n&&!y.current.includes(n)&&(m({event_type:13,view_type:1,view_parameter:92,component:13184,element:x(2),object_id_str:n,aux_data:{board_id:n,tab_title:i,referrer:19}}),y.current.push(n))})},[u,m,t,c,d]),b=(0,er.A)(()=>{_()},50);if((0,en.A)(()=>{u.current=Array(t.length).fill(void 0).map((e,t)=>u.current[t]||(0,i.createRef)())}),(0,i.useEffect)(()=>{_();let e=r.current;return e&&e.addEventListener("scroll",b),()=>{e?.removeEventListener("scroll",b)}},[_,b]),(0,i.useEffect)(()=>()=>{l.current&&(window.cancelAnimationFrame(l.current),l.current=null)}),!g)return null;let v=g.map(e=>({href:e.href,text:e.text,ref:e.ref}));return(0,k.jsx)(s.az,{ref:r,"data-test-id":"more-ideas-tabs",fit:!0,marginBottom:1,marginTop:1,overflow:"scrollX",children:(0,k.jsx)(s.tU,{activeTabIndex:e,onChange:({activeTabIndex:e})=>{let t=g?.[e];if(t){let r;r=t.boardId,f((0,ea.Y)(r,e)),m({event_type:101,view_type:1,view_parameter:92,component:13184,element:x(t.tabType),aux_data:{index:e.toString(),board_id:t.boardId,referrer:19},object_id_str:t.boardId})}let{pathname:r,state:n}=g?{pathname:(g[e]||g[0]).href,state:(g[e]||g[0]).locationState||void 0}:{};p(r,{state:n})},tabs:v})})}var el=r(603958),ed=r(309555),ec=r(236621),eu=r(809796),ep=r(614590);function eh(){(0,i.useEffect)(()=>{(0,n.A)("PreferencesUpdatedBanner","/app/www/pages/duplo/PreferencesUpdatedBanner.tsx")},[]);let{shouldRefreshHomefeed:e,clearRefreshFlag:t}=(0,eu.d)(),{showToast:r}=(0,$.CG)(),a=(0,A.A)(),o=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if(e&&!o.current){o.current=!0;let e=a.bt("首选项已更新！我们现在正在刷新你的页面。", "Preferences updated! We're refreshing your feed now.", "PreferencesUpdatedBanner.message", undefined, true);r(({hideToast:r})=>(0,k.jsx)(z.A,{duration:3e3,onHide:()=>{r(),t(),o.current=!1},text:e}))}else e||(o.current=!1)},[e,t,r,a]),null}var em=r(863153),ef=r(211735),eg=r(795822);function ex(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let ey=(0,eg.A)(()=>r.e("82269").then(r.bind(r,7841)),void 0,e=>7841,"app-www-pages-duplo-CoreActionsHeader",e=>["82269"]),e_=(0,eg.A)(()=>r.e("65469").then(r.bind(r,311398)),void 0,e=>311398,"app-www-stories-FullWidthPinStory",e=>["65469"]),eb=(0,eg.A)(()=>r.e("30369").then(r.bind(r,92120)),{ssr:!1},e=>92120,void 0,void 0),ev=(0,eg.A)(()=>r.e("30764").then(r.bind(r,535248)),void 0,e=>535248,"app-www-Homefeed-HomefeedMoreIdeasTabContent",e=>["30764"]),ew=(0,eg.A)(()=>r.e("45231").then(r.bind(r,528211)),void 0,e=>528211,"app-www-stories-LandingPageStory-LandingPageStory",e=>["45231"]),eA=(0,eg.A)(()=>Promise.all([r.e("18324"),r.e("37082"),r.e("3092")]).then(r.bind(r,892033)),{ssr:!1},e=>892033,void 0,void 0),eS=(0,eg.A)(()=>Promise.all([r.e("43744"),r.e("65693")]).then(r.bind(r,612044)),{ssr:!1},e=>612044,void 0,void 0),ej=(0,eg.A)(()=>r.e("6468").then(r.bind(r,640367)),{ssr:!1},e=>640367,void 0,void 0),ek=(0,eg.A)(()=>Promise.all([r.e("91796"),r.e("76557")]).then(r.bind(r,985724)),{ssr:!1},e=>985724,void 0,void 0),eI=(0,i.lazy)(()=>r.e("48177").then(r.bind(r,740264))),eP=(0,i.lazy)(()=>r.e("61570").then(r.bind(r,584857))),eC=(0,i.lazy)(()=>r.e("19558").then(r.bind(r,183749))),eT=(0,i.lazy)(()=>r.e("78682").then(r.bind(r,698593))),eM=(0,i.lazy)(()=>r.e("79566").then(r.bind(r,691613))),eE=(0,i.lazy)(()=>r.e("4666").then(r.bind(r,152225))),eF={feedKey:ep.bg,trafficSource:ep.mA,resourceName:ep.jC,feedItemProps:e=>({viewParameter:92,viewType:1,onFeedItemClick:()=>{e.onFeedItemClick&&e.onFeedItemClick()}}),pullToRefresh:!0},ez={first_page_size:"25",page_size:"10"},eH=({webMobileHomeFeedTakoverExperience:e})=>{let{feedKey:t,feedItemProps:r,pullToRefresh:n}=eF,i=(0,o.zy)(),d=(0,o.Zp)(),c=(0,a.d4)(({session:e})=>e.firstHomeFeedRequestAfterNux),u={webMobileHomeFeedTakoverExperience:e,location:i,navigate:d},p=(0,a.d4)(({feeds:e})=>e[t]??[]),{selectedUseCases:h,selectedPins:m}=(0,ec.p)(),f=(0,el.xx)(h,m),g=!c,x=f.length>0?{in_nux:c,nux_signals_map:f}:{in_nux:c},y={...ep.Vf,...g?{...ez}:{...x},in_local_navigation:!0,static_feed:!!(i&&(i.pathname.includes("pwt_performance_testing")||void 0!==(0,Y.A)(i.search).pwt_performance_testing))},_=(0,U.A)({name:ep.jC,options:y}),{isAtEnd:b,isFetching:v,fetchMore:w,data:A,refresh:S}=_,j={includeBackgroundImages:!0,includeVideos:!0,pins:Object.values((0,em.zy)())};c&&(0,C.GV)("home_product.homefeed.has_in_nux_flag",{sampleRate:.1,tags:{appType:"mweb"}});let I=(()=>{let{isGraphQLEnabledInGeneral:e}=(0,G.aR)(),{locale:t}=(0,N._8)(),r=(0,em.zy)();return({feedItems:n,prevFeedItems:i,finishedRefresh:a,unauthLandingPinStateForAuthHomefeed:{pinId:o,feedItem:s}})=>{if(!n.length)return null;if(a&&i.length>0){let e=(e,t)=>e.slice(0,t).map(e=>e.id),r=e(i,5),a=e(n,5),o={appType:"mweb",language:t&&t.slice(0,2)||"unknown",locale:t||"unknown"};(0,C.GV)("home_product.homefeed.refresh",{sampleRate:1,tags:o}),JSON.stringify(r)===JSON.stringify(a)&&(0,C.GV)("home_product.homefeed.refresh.no_change",{sampleRate:1,tags:o})}if(o&&!e){if(i.length>0&&i[0]!==n[0])return(0,K.y1)().removeItem(l.sH),{feedItem:null,pinId:null};else if((0===i.length||i[0]===n[0]&&i.length!==n.length||!s)&&r[o]&&!n.slice(0,5).some(({id:e})=>e===o))return{feedItem:{id:o,type:"pin",trackingParams:n[0].trackingParams},pinId:o}}return null}})(),P=A?.length?A[0]:null;if(e&&e.display_data?.in_checklist_education&&e.display_data?.num_columns_requested===2){let e={type:"fullWidthBreakIn",value:{index:0,content:P?.id&&(0,k.jsx)(ef.A,{storyId:P.id,children:e=>(0,k.jsx)(e_,{slotIndex:0,story:e,viewParameter:3833,viewType:604})})}},i=p.slice(1);return(0,k.jsx)(s.az,{"data-test-id":"homefeed",children:(0,k.jsx)(X.RM,{authHomefeedComponentDidUpdate:I,feedItemProps:r&&r(u),feedItems:i,feedItemsAdjustment:e,feedKey:t,pagination:{hasNext:!b,isLoadingNext:v,loadNext:()=>w(),refetch:()=>S()},pullToRefresh:n,trafficSource:ep.mA,visuallyCompleteProfilerOptions:j})})}return g&&!e?.display_data?(0,k.jsx)(s.az,{"data-test-id":"homefeed-ssr",children:(0,k.jsx)(X.Ir,{authHomefeedComponentDidUpdate:I,feedItemProps:r&&r(u),feedKey:ep.bg,pullToRefresh:n,resource:_,serverRender:!0,trafficSource:ep.mA,visuallyCompleteProfilerOptions:j})}):(0,k.jsx)(s.az,{"data-test-id":"homefeed",children:(0,k.jsx)(X.Ir,{authHomefeedComponentDidUpdate:I,feedItemProps:r&&r(u),feedKey:t,pullToRefresh:n,resource:_,trafficSource:ep.mA,visuallyCompleteProfilerOptions:j})})},eR=(0,eg.A)(()=>r.e("91928").then(r.bind(r,293899)),{ssr:!1},e=>293899,void 0,void 0),eO=(0,eg.A)(()=>r.e("66318").then(r.bind(r,674269)),{ssr:!1},e=>674269,void 0,void 0),eD=(0,eg.A)(()=>r.e("25312").then(r.bind(r,421507)),{ssr:!1},e=>421507,void 0,void 0),eL=(0,eg.A)(()=>r.e("24701").then(r.bind(r,504716)),{ssr:!1},e=>504716,void 0,void 0),eN=(0,eg.A)(()=>r.e("34311").then(r.bind(r,342330)),{ssr:!1},e=>342330,void 0,void 0),eU=(0,eg.A)(()=>r.e("79676").then(r.bind(r,403351)),{ssr:!1},e=>403351,void 0,void 0);class eW extends i.PureComponent{constructor(...e){super(...e),ex(this,"state",{...(0,el.of)(),currentTabIndex:"number"==typeof this.props.selectedTabIndex?this.props.selectedTabIndex:0,showUnlinkTokenExpiredModal:!1,showDeleteAccountSurveyModal:!1,showYipModal:!1,shouldDismissCoreActionsHeader:!1,showQRAppErrorBanner:!1}),ex(this,"renderOptInInterestPicker",()=>{let{everythingFeedExperience:e,isLimitedLogin:t}=this.props,{extraPlpImages:r,extraBlpImages:n}=this.state,i=!t&&e&&504192===e.experience_id,a=i&&e&&e.display_data&&e.display_data.full_screen_modal;return e&&i?(0,k.jsx)(c.A,{name:"SafeSuspense_HomePage_OptInInterestPicker",children:a?(0,k.jsx)(eU,{experience:e,extraImageInfo:r.length>0?r:n,viewParameter:92,viewType:1}):(0,k.jsx)(eL,{experience:e,viewParameter:92,viewType:1})}):null})}static getDerivedStateFromProps(e){let{selectedTabIndex:t,navigate:r,location:n}=e;return(0,Y.A)(n.search).show_qr_app_error?(r("/",{replace:!0}),{showQRAppErrorBanner:!0}):"number"==typeof t?{currentTabIndex:t}:null}componentDidMount(){let{dispatchViewedSharedPins:e,location:t,i18n:r,showToast:n,navigate:i}=this.props,{sharedPinData:a}=this.state;(0,ed.h)(!1),(0,d.A)(),a&&Object.keys(a).length>0&&e(a),t.state?.unlinkTokenInvalid&&this.setState({showUnlinkTokenExpiredModal:!0}),t.state?.isCloseAccountReasonOpen&&this.setState({showDeleteAccountSurveyModal:!0}),t.state?.showError&&n(({hideToast:e})=>(0,k.jsx)(z.A,{duration:5e3,onHide:e,text:r.bt("找不到该点子！试试搜索类似的点子。", "We can’t find that idea! Try searching for one just like it.", " - ", undefined, true),type:"error"})),(0,Y.A)(t.search).show_yip_modal&&(i("/",{replace:!0}),this.setState({showYipModal:!0})),this.props.shouldRefreshHomefeed&&(0,Q.Y9)("homefeed")}render(){let{checkExperiment:e,currentUserId:t,currentUsername:r,everythingFeedExperience:n,navigate:a,i18n:o,isAuthenticated:l,isEligibleForCoreActionsHeader:d,isPartner:h,location:m,moreIdeasStory:f,newUserWelcomeStoryExperience:g,webMobileHomeFeedTakoverExperience:x,selectedTabBoardId:y,tabBoards:_,shouldRefreshHomefeed:b}=this.props,{currentTabIndex:v,showUnlinkTokenExpiredModal:w,showDeleteAccountSurveyModal:A,showYipModal:S,shouldDismissCoreActionsHeader:j,showQRAppErrorBanner:I}=this.state,P=(0,Y.A)(m.search),C=P&&P.boardId||y;if(n&&!I)switch(n.experience_id){case 40002:case 10105:return(0,k.jsx)(c.A,{name:"SafeSuspense_HomePage_Nux",children:(0,k.jsx)(W.A,{fallback:(0,k.jsx)(B.A,{accessibilityLabel:this.props.i18n.bt("正在加载新的用户教育", "Loading new user education", "Loading spinner", undefined, true)}),children:h?(0,k.jsx)(eD,{experience:n}):(0,k.jsx)(eO,{experience:n})})});case 500681:return(0,k.jsx)(c.A,{name:"SafeSuspense_HomePage_ContactUpdate",children:(0,k.jsx)(eR,{fallback:(0,k.jsx)(B.A,{accessibilityLabel:this.props.i18n.bt("正在加载体验", "Loading experience", "loading experience spinner", undefined, true)})})})}let T=l&&e("mweb_hf_core_actions_header").anyEnabled&&d,z=()=>{this.setState({shouldDismissCoreActionsHeader:!0})};return(0,k.jsx)(q.A,{viewParameter:92,viewType:1,children:(0,k.jsx)(V.A,{view:1,viewParameter:92,children:(0,k.jsxs)(O.default,{dataLayoutShiftBoundaryId:"AuthHomePageContainer",hasFixedHeader:!0,children:[I&&(0,k.jsx)(s.az,{marginTop:4,children:(0,k.jsx)(eE,{})}),(0,k.jsx)(Z.A,{text:o.bt("主页", "Home", "HomePage.HiddenAccessibilityHeader", undefined, true)}),!!_?.length&&(0,k.jsx)(R.default,{hideOnScroll:l,noPadding:!0,overrideTop:0,children:(0,k.jsx)(s.az,{paddingY:1,children:(0,k.jsx)(es,{currentTabIndex:v,tabBoards:_||[]})})}),f&&(0,k.jsx)(s.az,{marginEnd:-4,marginStart:-4,paddingY:2,children:(0,k.jsx)(ef.A,{storyId:f.id||"",children:e=>(0,k.jsx)(e_,{slotIndex:0,story:e,viewParameter:92,viewType:1},f.id)})}),0!==v&&C&&v<=(_?.length??0)&&(0,k.jsx)(ev,{boardId:C})||(0,k.jsxs)(i.Fragment,{children:[(0,k.jsx)(M,{experience:n}),(0,k.jsx)(u.Vj,{experience:n,placementId:40001}),(0,k.jsx)(u.nU,{placementId:40001}),(0,k.jsx)(u.aR,{experience:n,placementId:40001}),(0,k.jsx)(p.A,{placementId:n?.placement_id}),(0,k.jsx)(F.A,{placementId:1000544}),(0,k.jsx)(E.A,{placementId:1000558}),(0,k.jsx)(u.Je,{eligibleIds:[500726,500866,500735,500833,501182,501275,501385,501358,501908,501909,503291],experience:n,children:(0,k.jsx)(W.A,{children:(0,k.jsx)(eP,{experience:n})})}),n&&(0,k.jsx)(u.Je,{eligibleIds:[507483],experience:n,children:({dismiss:e,experience:{display_data:t}})=>{let r=!("is_blocking"in t)||t.is_blocking;return(0,k.jsx)(eA,{container:"HomePage",dismiss:e,isBlockingModal:r})}}),n&&(0,k.jsx)(u.Je,{eligibleIds:[507661],experience:n,children:({dismiss:e,experience:{display_data:t}})=>(0,k.jsx)(eS,{container:"HomePage",displayData:t,onDismiss:e})}),n&&(0,k.jsx)(u.Je,{eligibleIds:[507924],experience:n,children:({complete:e,dismiss:t})=>(0,k.jsx)(ej,{onComplete:e,onDismiss:t})}),n&&(0,k.jsx)(u.Je,{eligibleIds:[508387],experience:n,placementId:40001,children:({complete:e,dismiss:t,experience:r})=>(0,k.jsx)(ek,{complete:e,dismiss:t,experience:r})}),n&&(0,k.jsx)(u.Je,{eligibleIds:[505326],experience:n,children:({complete:e,dismiss:t})=>(0,k.jsx)(i.Suspense,{children:(0,k.jsx)(eM,{complete:e,dismiss:t})})}),n&&(0,k.jsx)(u.Je,{eligibleIds:[505801],experience:n,children:({complete:e})=>(0,k.jsx)(i.Suspense,{children:(0,k.jsx)(eT,{complete:e})})}),g?.display_data?.story&&g.display_data.showUpdatedLandingPageStory&&(0,k.jsx)(ew,{isMoreIdeasTabsVisible:!!_?.length,newUserWelcomeStoryExperience:g}),(0,k.jsxs)(s.az,{marginTop:2*(!_?.length&&!f),children:[!j&&T&&(0,k.jsx)(ey,{onDismiss:z,username:r||""}),(0,k.jsx)(eH,{webMobileHomeFeedTakoverExperience:x})]})]}),w&&(0,k.jsx)(W.A,{children:(0,k.jsx)(s.az,{"data-test-id":"unlink-expired-token",children:(0,k.jsx)(eC,{onDismiss:()=>{a("/",{replace:!0}),this.setState({showUnlinkTokenExpiredModal:!1})}})})}),A&&(0,k.jsx)(W.A,{children:(0,k.jsx)(eI,{isPartner:h,onDismiss:()=>{a("/",{replace:!0}),this.setState({showDeleteAccountSurveyModal:!1})},userId:t,username:r})}),S&&(0,k.jsx)(c.A,{name:"YearInPreviewConfirmPublishModal",children:(0,k.jsx)(eN,{onModalDismiss:()=>{this.setState({showYipModal:!1})}})}),this.renderOptInInterestPicker(),0===v&&n&&(0,k.jsx)(u.Je,{eligibleIds:[508418],experience:n,children:()=>b?(0,k.jsx)(eh,{}):(0,k.jsx)(eb,{hasTabBoards:(_?.length??0)>0})})]})})})}}let eB=[];function eK(){(0,i.useEffect)(()=>{(0,n.A)("HomePage","/app/www/pages/duplo/HomePage.tsx")},[]);let e=(0,A.A)(),t=(0,a.wA)(),r=(0,H.A)(),{showToast:s}=(0,$.CG)(),l=(0,o.Zp)(),d=(0,o.zy)(),{checkExperiment:c}=(0,L.A)(),{shouldRefreshHomefeed:p,clearRefreshFlag:h}=(0,eu.d)(),{experience:m}=(0,u.Rf)(40001),{experience:f}=(0,u.Rf)(1000115),{experience:g}=(0,u.Rf)(1000411),x=(0,a.d4)(({feeds:e})=>e.homefeed),y=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabBoardId),_=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabIndex),{isAuth:b,isLimitedLogin:v}=r,w=r.isAuth?r.id:void 0,S=r.isAuth?r.username:void 0,j=!!r.isAuth&&r.isPartner,I=(0,J.qJ)(),P=Array.isArray(x)?x:[],C=!I&&P[0]&&"story"===P[0].type?P[0]:null,T=(0,a.d4)(({stories:e})=>C?e[C.id]:null),M=T&&T.story_type&&T.story_type.startsWith("boards_more_ideas_feed_upsell")?T:null,E=P.find(({type:e})=>"home_feed_tabs"===e)?.tabs,{data:F}=(0,U.A)(b&&c("mweb_hf_core_actions_header",{dangerouslySkipActivation:!0}).anyEnabled?{name:"UserResource",options:{user_id:r.id,field_set_key:"core_actions_header"}}:null),z=(0,J.M)();(0,D.A)(d,s,e);let R={checkExperiment:c,currentUserId:w,currentUsername:S,dispatchViewedSharedPins:e=>t({type:"SET_VIEWED_SHARED_PINS",payload:{pins:e}}),everythingFeedExperience:m,navigate:l,i18n:e,isAuthenticated:b,isEligibleForCoreActionsHeader:F?.is_eligible_for_core_actions_header,isLimitedLogin:v,isMobile:z,isPartner:j,location:d,moreIdeasStory:M,newUserWelcomeStoryExperience:g,selectedTabBoardId:y,selectedTabIndex:_,showToast:s,tabBoards:E??eB,webMobileHomeFeedTakoverExperience:f,shouldRefreshHomefeed:p,clearRefreshFlag:h};return(0,k.jsx)(eW,{...R})}},614590(e,t,r){r.d(t,{Vf:()=>s,bg:()=>i,jC:()=>o,ks:()=>l,mA:()=>a});var n=r(405840);let i="homefeed",a="feed_home",o="UserHomefeedResource",s={field_set_key:"mobile_grid_item",prepend:!1},l=(0,n.A)(s)},131661(e,t,r){r.d(t,{Y:()=>n});let n=(e,t)=>({type:"SET_ACTIVE_HOMEFEED_TAB",payload:{boardId:e,index:t}})},792041(e,t,r){r.d(t,{AD:()=>p,X2:()=>d,e6:()=>s,sN:()=>l,x2:()=>c});var n=r(321571),i=r(301704),a=r(890850);function o(e,t,r,i){return n.A.create("UserFollowResource",{user_id:e,invite_code:i||void 0,aux_data:t?{pin_id:t}:void 0,client_tracking_params:r})}function s(e,t=null,r,n){return i=>{o(e,t,r,n).callCreate().catch(()=>i((0,a.pV)(e,!1))),i((0,a.pV)(e,!0))}}function l(e,t=null,r,n){return async i=>{i((0,a.pV)(e,!0)),await o(e,t,r,n).callCreate().catch(t=>{throw i((0,a.pV)(e,!1)),t})}}function d(e,t=null,r){return n=>{o(e,t,r).callDelete().catch(()=>n((0,a.pV)(e,!0))),n((0,a.pV)(e,!1))}}function c(e,t=null,r){return async n=>{n((0,a.pV)(e,!1)),await o(e,t,r).callDelete().catch(t=>{throw n((0,a.pV)(e,!0)),t})}}let u=(e,t)=>({type:"USER_BULK_FOLLOW",payload:{ids:e,value:t}}),p=e=>t=>{e.length>0&&((0,i.A)({url:"/v3/users/follow/",method:"PUT",data:{followee_ids:e}}).catch(()=>t(u(e,!1))),t(u(e,!0)))}},890850(e,t,r){r.d(t,{Bt:()=>c,Fq:()=>p,LR:()=>a,Wi:()=>h,oH:()=>u,om:()=>d,pV:()=>o,yX:()=>s});var n=r(301704),i=r(588275);function a(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}let o=(e,t)=>({type:"USER_FOLLOW",payload:{id:e,value:t}}),s=(e,t)=>({type:"USER_FOLLOWING_COUNT",payload:{id:e,following:t}}),l=(e,t)=>({type:"USER_BLOCK",payload:{id:e,value:t}}),d=({id:e,orbacSubjectId:t,blockSource:r,blockContext:i,logContextEvent:a})=>async o=>{o(l(e,!0));let s=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"PUT",data:{orbac_subject_id:t,block_source:r,block_context:i}}).catch(()=>o(l(e,!1)));return a({event_type:54,object_id_str:e}),s},c=(e,t)=>async r=>{r(l(e,!1));let i=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"DELETE"}).catch(()=>r(l(e,!0)));return t({event_type:55,object_id_str:e}),i};function u(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}let p=(e,t)=>()=>(0,n.A)({url:"/v3/users/state/{state}/",urlParams:{state:e},method:"PUT",data:{value:t}}),h=(e,t,r)=>(a,o)=>{(0,n.A)({url:"/v3/users/me/",method:"POST"}).then(()=>{r({event_type:48,object_id_str:o().session.userId}),e(),(0,i.A)()},t)}},211735(e,t,r){r.d(t,{A:()=>i});var n=r(924660);function i({children:e,storyId:t}){let r=(0,n.d4)(({stories:e})=>e[t]);return r&&e(r)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/19142.zh_CN-e7173727293eb594.mjs.map