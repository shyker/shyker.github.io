(self.modernJsonp=self.modernJsonp||[]).push([["19414"],{410727(e,t,i){i.r(t),i.d(t,{default:()=>n});let o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MoreIdeasPreviewStory_story",selections:[{alias:null,args:null,kind:"ScalarField",name:"referringSource",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"474x")'}],type:"Pin",abstractKey:null}],storageKey:null}],type:"Story",abstractKey:null};o.hash="f6776ff7c6fc3ce9a1f4b72a5dbaa0c2";let n=o},425170(e,t,i){i.d(t,{A:()=>s});var o=i(111302);let n=new Set([92]),r=new Set([154]);function s(e){let t=[];return e.forEach(e=>{if("story"===e.type?n.has(e.container_type)||r.has(e.container_type)||o.c.has(e.story_type)||o.S.has(e.story_type):1){let i=t[t.length-1];Array.isArray(i)?i.push(e):t.push([e])}else t.push(e)}),t}},619307(e,t,i){i.d(t,{A:()=>l});var o=i(657140);let n=null,r=!1,s=0,a=()=>{n&&clearTimeout(n),r=!0,n=setTimeout(()=>{r=!1},100)},l=()=>{let[e,t]=(0,o.useState)(!1),i=(0,o.useRef)(null);(0,o.useEffect)(()=>(0===s&&window.addEventListener("scroll",a),s+=1,()=>{i.current&&clearTimeout(i.current),(s-=1)||window.removeEventListener("scroll",a)}),[]);let n=e=>{i.current&&clearTimeout(i.current),i.current=e&&r?setTimeout(()=>n(!0),100):setTimeout(()=>{t(e)},32)};return{isHovering:e,hoverHandlers:(0,o.useRef)({onMouseOver:()=>n(!0),onMouseLeave:()=>n(!1)}).current}}},71749(e,t,i){i.d(t,{N:()=>c,U:()=>h});var o=i(657140),n=i(767216),r=i(301704);let s={boardMap:{}};function a(e,t){if(e=e||s,"BLOCKING_ACTIONS_UPDATED"===t.type){let{payload:{boardId:i,blockingActions:o}}=t,n=null,r=null,s={};return o.forEach(({section_id:e,progress:t,id:i,created_timestamp:o})=>{let a={id:i,createdAt:o,progress:t};e?"-1"===e?n=a:s[e]=a:r=a}),{...e,boardMap:{...e.boardMap,[i]:{wholeBoard:n,unorganized:r,sectionMap:s}}}}return e}var l=i(135656);let{Provider:d,getMaybe:c}=(0,n.A)("BlockingAction");async function u(e){let t=await (0,r.A)({url:"/v3/boards/{board}/",urlParams:{board:e},data:{fields:["board.id","board.blocking_actions"]}});return new Promise((e,i)=>{let o=t&&t.resource_response&&t.resource_response.data&&t.resource_response.data.blocking_actions;o?e(o):i(Error("No blocking actions found in the response"))})}function h({children:e}){let[t,i]=(0,o.useReducer)(a,s),n=(0,o.useCallback)(e=>u(e).then(t=>(i({type:"BLOCKING_ACTIONS_UPDATED",payload:{boardId:e,blockingActions:t}}),t)),[]),r=(0,o.useMemo)(()=>({blockingActions:t,fetchBlockingActions:n}),[t,n]);return(0,l.jsx)(d,{value:r,children:e})}},723029(e,t,i){i.d(t,{A:()=>v});var o=i(906494),n=i(71749),r=i(335831),s=i(657140),a=i(836737),l=i(139466),d=i(396901),c=i(616275),u=i(491149),h=i(135656);function p(e,t,i){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:o+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class _ extends s.Component{constructor(...e){super(...e),p(this,"state",{hiding:!1,visible:!1}),p(this,"handleHide",()=>{this.setState({hiding:!0}),this.timeout=window.setTimeout(this.props.onHide,200)}),p(this,"handleMouseEnter",()=>{window.clearTimeout(this.timeout)}),p(this,"handleMouseLeave",()=>{this.timeout=window.setTimeout(this.handleHide,this.props.duration||2e3)})}componentDidMount(){this.toastText&&(window.setTimeout(()=>{this.setState({visible:!0})},100),this.timeout=window.setTimeout(this.handleHide,this.props.duration||2e3))}get toastText(){let{actionType:e,actionStatus:t,location:i}=this.props,{isSection:o,name:n}=i,r="completed"===t;switch(e){case"create_section":return r?this.props.i18n.bt("已创建区块", "Created section", "toast text to indicate a section has been created successfully", undefined, true):this.props.i18n.bt("正在创建区块", "Creating section", "toast text to indicate a section is being created", undefined, true);case"delete_pins":if(o)return r?(0,c.A)(this.props.i18n.bt("已删除来自{{sectionName}}的 Pin 图", "Deleted Pins from {{sectionName}}", "toast text to notify Pins have been deleted from a section", undefined, true),{sectionName:n}):(0,c.A)(this.props.i18n.bt("正在删除来自{{sectionName}}的 Pin 图", "Deleting Pins from {{sectionName}}", "toast text to notify Pins are being deleted from a section", undefined, true),{sectionName:n});return r?(0,c.A)(this.props.i18n.bt("已删除来自{{boardName}}的 Pin 图", "Deleted Pins from {{boardName}}", "toast text to notify Pins have been deleted from a board", undefined, true),{boardName:n}):(0,c.A)(this.props.i18n.bt("正在删除来自{{boardName}}的 Pin 图", "Deleting Pins from {{boardName}}", "toast text to notify Pins are being deleted from a board", undefined, true),{boardName:n});case"move_pins":if(o)return r?(0,c.A)(this.props.i18n.bt("已移动至{{sectionName}}", "Moved to {{sectionName}}", "toast text to notify pins have been moved to this section", undefined, true),{sectionName:n}):(0,c.A)(this.props.i18n.bt("正在移至{{sectionName}}…", "Moving to {{sectionName}}", "toast text to notify pins are being moved to this section", undefined, true),{sectionName:n});return r?(0,c.A)(this.props.i18n.bt("已移动至{{boardName}}", "Moved to {{boardName}}", "toast text to notify pins have been moved to this board", undefined, true),{boardName:n}):(0,c.A)(this.props.i18n.bt("正在移至{{boardName}}…", "Moving to {{boardName}}", "toast text to notify pins are being moved to this board", undefined, true),{boardName:n});case"merge":if(o)return r?(0,c.A)(this.props.i18n.bt("已移动至{{sectionName}}", "Moved to {{sectionName}}", "toast text to notify another section has been merged to this section", undefined, true),{sectionName:n}):(0,c.A)(this.props.i18n.bt("正在移至{{sectionName}}…", "Moving to {{sectionName}}", "toast text to notify another section is being merged to this section", undefined, true),{sectionName:n});return r?(0,c.A)(this.props.i18n.bt("已移动至{{boardName}}", "Moved to {{boardName}}", "toast text to notify another board has been merged to this board", undefined, true),{boardName:n}):(0,c.A)(this.props.i18n.bt("正在移至{{boardName}}…", "Moving to {{boardName}}", "toast text to notify another board is being merged to this board", undefined, true),{boardName:n});default:return null}}render(){let{actionStatus:e,deviceType:t}=this.props,{visible:i,hiding:o}=this.state,{toastText:n}=this,{marginTop:r,opacity:s,position:d,pointerEvents:c,transform:u,transition:p,visibility:_}=(0,l.A)({deviceType:t,hiding:o,visible:i});return n?(0,h.jsx)(a.az,{dangerouslySetInlineStyle:{__style:{transform:u,transition:p,visibility:_,pointerEvents:c}},marginTop:r,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,opacity:s,position:d,children:(0,h.jsx)(a.y8,{text:n,type:"completed"===e?"default":"progress"})}):null}}function m(e){(0,s.useEffect)(()=>{(0,r.A)("BoardBlockingActionToast","/app/www/BlockingActionsContext/BoardBlockingActionToast.tsx")},[]);let t=(0,u.Ay)(),i=(0,d.A)();return(0,h.jsx)(_,{...e,deviceType:t,i18n:i})}let g=["merge","move_pins","create_section"],f=0,b={},y=(e,t,i,o)=>({hideToast:n})=>(0,h.jsx)(m,{actionStatus:e,actionType:t,duration:2e3,location:{name:o?o.title??"":i.name??"",isSection:!!o},onHide:n});function v(){let{showToast:e}=(0,o.CG)(),{fetchBlockingActions:t}=(0,n.N)()??{fetchBlockingActions:e=>new Promise(e=>e([]))};return{showBlockingActionToast:({actionType:i,board:o,section:n})=>{e(y("inProgress",i,o,n)),function({check:e,checkDelay:t,checkInterval:i,onComplete:o}){let n=`timeout${f}`;f+=1;let r=()=>{let t=Date.now();e().then(e=>{let s=Date.now()-t;e?(o(),delete b[n]):b[n]=setTimeout(r,Math.max(1e3,i-s))}).catch(()=>{delete b[n]})};b[n]=setTimeout(r,t)}({check:()=>t(o.id).then(e=>!function({blockingActions:e,actionType:t,boardId:i,sectionId:o}){return e.find(e=>(function(e){switch(e){case 22:return"delete_board";case 7172:case 7173:return"merge";case 900:case 7158:case 7109:return"delete_pins";case 901:case 7108:return"move_pins";case 7100:return"create_section";case 7102:return"delete_section";default:return null}})(e.action_type)===t&&!(g.includes(e.action_type)&&e.is_origin)&&e.board_id===i&&(o?o===e.section_id:!e.section_id||"-1"===e.section_id)&&1!==e.progress)}({blockingActions:e,actionType:i,boardId:o.id,sectionId:n&&n.id})),checkDelay:2e3,checkInterval:5e3,onComplete:()=>e(y("completed",i,o,n))})}}}},451658(e,t,i){i.d(t,{Sd:()=>o,p$:()=>n,th:()=>r});let o=(e,t)=>{let i="object"==typeof t?.owner?t.owner?.id:t?.owner;return e.isAuth&&i===e.id},n=(e,t)=>!!(e.isAuth&&t.collaborated_by_me),r=(e,t)=>o(e,t)?3069:3070},54173(e,t,i){function o(e,t){return{type:"SECTION_ADDED",payload:{boardId:e,section:t}}}function n(e,t){return{type:"SECTION_DELETED",payload:{boardId:e,sectionId:t}}}i.d(t,{I4:()=>o,X2:()=>r,vb:()=>n});let r=(e,t)=>({type:"BOARD_SECTION_EDIT",payload:t})},931510(e,t,i){i.d(t,{A:()=>d});var o=i(301704),n=i(13324),r=i(54173),s=i(120379),a=i(310206),l=i(831064);function d(e,t,i){return d=>(0,o.A)({url:"/v3/board/sections/{source_section}/merge/{target_section}/",urlParams:{source_section:t,target_section:i},method:"POST",data:{fields:["boardsection.id","boardsection.board()","board.id","board.blocking_actions"]}}).then(o=>Promise.all([d((0,r.vb)(e,t)),d((0,n.Q5)("BoardSectionsRepinResource",{board_id:e})),d((0,s.A)(i)),d((0,a.eO)(l.A.BOARD_SECTION_PINS,i))]).then(()=>o))}},59404(e,t,i){i.d(t,{A:()=>y});var o=i(335831),n=i(657140),r=i(836737),s=i(86527),a=i(47998),l=i(396901),d=i(508765),c=i(425170),u=i(491149),h=i(32712),p=i(894621),_=i(453100),m=i(600727),g=i(465191),f=i(564252),b=i(135656);function y(e){(0,n.useEffect)(()=>{(0,o.A)("BoardExpandedSections","/app/www/save/board/BoardDefaultTabContent/BoardExpandedSections.tsx")},[]);let t=(0,u.qJ)(),i=(0,a.A)(),y=(0,l.A)(),v=(0,h.A)(),x=(0,p.H7)(i,v),{board:A,onLoadedAll:w,viewParameter:P}=e,{id:j,pin_count:S,privacy:z}=A,I=(0,m.A)(A),{data:C,isAtEnd:B,isFetching:T,isLoaded:D}=(0,d.A)({name:"ApiResource",options:{data:{fields:["pin.cacheable_id","pin.created_at","pin.description","pin.domain","pin.grid_title","pin.id","pin.is_downstream_promotion","pin.is_playable","pin.is_repin","pin.is_uploaded","pin.is_video","pin.images[170x,136x136,236x,474x,736x,orig]","pin.link","pin.price_currency","pin.price_value","pin.rich_summary()","pin.repin_count","pin.title","pin.type"]},url:`/v3/board/${j}/expanded_sections/`,redux_normalize_feed:!0,...(0,s.A)(z)&&x?{orbac_subject_id:x}:{}}});if((0,n.useEffect)(()=>{B&&w()},[B,w]),!D)return(0,b.jsx)(r.y$,{accessibilityLabel:y.bt("图板区块加载图示", "Board sections loading spinner", " - ", undefined, true),show:!0});let E=(0,c.A)(C||[]),M={loadNext:()=>void 0,hasNext:B,isLoadingNext:T,refetch:()=>void 0};return(0,b.jsx)(r.az,{"data-test-id":"board-expanded-sections",id:"board-expanded-sections-wrapper",paddingX:t?2:1,width:"100%",children:E.map((e,i)=>{if(Array.isArray(e)){let t=`board-expanded-sections-feed-${i}`;return(0,b.jsx)(f.A,{feedItems:e,feedKey:`board-expanded-sections:${j}`,pagination:M,renderFeedItem:(e,t)=>(0,b.jsx)(g.A,{children:(0,b.jsx)(_.A,{auxData:{board_id:j,board_pin_count:S??0},parentPinKey:null,pinKey:{type:"Legacy",data:e},slotIndex:t,surface:I?"FeaturedBoardPinGrid":"BaseBoardPinGrid",viewParameter:P,viewType:164})})},t)}return"story"===e.type&&"board_expanded_section_title"===e.story_type?(0,b.jsxs)(r.az,{marginBottom:t?4:2,marginTop:t?8:4,paddingX:t?3:1,children:[(0,b.jsx)(r._Y,{size:t?"600":"400",children:e.title?.format??""}),e.description?.format?(0,b.jsx)(r.az,{marginTop:2,children:(0,b.jsx)(r.KJ,{size:t?"300":"100",children:e.description.format})}):null]},`board-expanded-sections-story-${e.id}`):null})})}},550325(e,t,i){i.d(t,{A:()=>ep});var o=i(657140),n=i(836737),r=i(129625),s=i(268989),a=i(795561),l=i(47998),d=i(491149),c=i(242595),u=i(321791),h=i(335831),p=i(396901),_=i(221718),m=i(424120),g=i(451658),f=i(135656);function b(e,t,i){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:o+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let y=Object.freeze({}),v={custom:11566,newest:11564,oldest:11565,most_comments:11563,most_reactions:11562,by_pinner:11561};class x extends o.Component{constructor(...e){super(...e),b(this,"handleChange",({event:e,value:t})=>{let{onChange:i,viewer:o,board:n}=this.props;e.stopPropagation(),window.scrollTo({top:0,left:0,behavior:"smooth"}),((e,t,i)=>{if(!e.isAuth)return;let o=m.Ay.getItem(_.OR)||y,n=o[e.id]||{},r={...o,[e.id]:{...n,[t.id]:i}};m.Ay.setItem(_.OR,r)})(o,n,t),i&&i(t),this.props.logContextEvent({event_type:101,view_type:5,view_parameter:(0,g.th)(o,n),component:13475,element:v[t],aux_data:{board_id:n.id}})}),b(this,"logDropdownClick",()=>{let{board:e,viewer:t}=this.props;this.props.logContextEvent({event_type:101,view_type:5,view_parameter:(0,g.th)(t,e),component:13486,element:11567,aux_data:{board_id:e.id}})}),b(this,"handleKeyPress",e=>{let{charCode:t=0}=e;32===t&&(e.preventDefault(),this.logDropdownClick())})}render(){let{currentView:e}=this.props,t=[{value:"custom",label:this.props.i18n.bt("自定义", "Custom", "Option for users to filter their Pins in a custom order (as it currently is)", undefined, true)},{value:"most_reactions",label:this.props.i18n.bt("最多互动", "Most reactions", "Option for users to filter their Pins by the most reactions", undefined, true)}];return(0,f.jsx)("div",{onClick:this.logDropdownClick,onKeyPress:this.handleKeyPress,role:"listbox",tabIndex:0,children:(0,f.jsx)(n.Bq,{id:"gbFilterSelectlist",onChange:this.handleChange,size:"lg",value:e,children:t.map(e=>(0,f.jsx)(n.Bq.Option,{...e},e.label))})})}}let A=function(e){let{logContextEvent:t}=(0,r.o)(),i=(0,p.A)();return(0,f.jsx)(x,{...e,i18n:i,logContextEvent:t})};var w=i(100622),P=i(508765);function j({selected:e}){(0,o.useEffect)(()=>{(0,h.A)("DensityIcons","/app/www/save/board/PinRepViewSelector/DensityIcons.tsx")},[]);let t=(0,p.A)();return(0,f.jsx)(n.In,{accessibilityLabel:t.bt("密集", "Dense", "Label for selecting the dense pin density view", undefined, true),color:e?"default":"subtle",icon:"view-type-dense",size:24})}function S({selected:e}){(0,o.useEffect)(()=>{(0,h.A)("DensityIcons","/app/www/save/board/PinRepViewSelector/DensityIcons.tsx")},[]);let t=(0,p.A)();return(0,f.jsx)(n.In,{accessibilityLabel:t.bt("普通", "Regular", "Label for selecting the regular pin density view", undefined, true),color:e?"default":"subtle",icon:"view-type-default",size:24})}var z=i(366101),I=i(693953);class C extends o.Component{constructor(...e){var t,i,o;super(...e),t="handleItemChange",i=({activeIndex:e})=>{let{viewType:t,component:i,pinView:o,logContextEvent:n}=this.props,r=0===e?"regular":"dense";(0,z.A)({boardDensity:r,component:i,viewType:t},n),(0,I.A)({density:r,surface:o}),"board"===o?this.props.updateBoardPinDensity?.(r):this.props.updateProfilePinDensity?.(r)},(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:o+"")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidUpdate(){let{metadata:e,pinView:t,updatedBoardPinDensity:i,updateBoardPinDensity:o,updateProfilePinDensity:n}=this.props;if(e&&e.data&&""===i){let{profile_pin_rep_view_type:i,board_pin_rep_view_type:r}=e.data;"board"===t&&(i?o?.(i):o?.("regular")),"profile"===t&&(r?n?.(r):n?.("regular"))}}render(){let{metadata:e,updatedBoardPinDensity:t}=this.props;return e&&e.data?(0,f.jsx)("div",{className:"OwnBoardSelector",children:(0,f.jsx)(n.Iz,{items:[(0,f.jsx)(S,{selected:"regular"===t}),(0,f.jsx)(j,{selected:"dense"===t})],onChange:this.handleItemChange,responsive:!0,selectedItemIndex:+("dense"===t)})}):null}}function B(e){(0,o.useEffect)(()=>{(0,h.A)("PinRepViewSelector","/app/www/save/board/PinRepViewSelector/PinRepViewSelector.tsx")},[]);let t=(0,c.WO)(),{logContextEvent:i}=(0,r.o)(),n=(0,l.A)(),s=(0,P.A)({name:"UserMetadataResource",options:{user:{id:n.isAuth?n.username:""}},noCache:!0}),a=("board"===e.pinView?t?.boardPinDensity:t?.profilePinDensity)??"";return(0,f.jsx)(C,{...e,logContextEvent:i,metadata:s,updateBoardPinDensity:t?.setBoardPinDensity,updatedBoardPinDensity:a,updateProfilePinDensity:t?.setProfilePinDensity})}function T({board:e,currentView:t,inBoardOrganizationMode:i,onContentViewChange:r,onOrganizeClick:s,pinCount:a,showSortOptions:d}){(0,o.useEffect)(()=>{(0,h.A)("BoardPinsActionBar","/app/www/save/board/BoardDefaultTabContent/BoardPinsActionBar.tsx")},[]);let c=(0,p.A)(),u=(0,l.A)();return(0,f.jsxs)(n.az,{alignItems:"center",direction:"row",display:"flex",marginEnd:-1,marginStart:-1,children:[(0,f.jsx)(n.az,{flex:"grow",paddingX:1,children:(0,f.jsx)(n._Y,{children:c.bt("Pin 图", "Pins", "Heading for Pins outside of board sections on board page", undefined, true)})}),d&&a<=500&&(0,f.jsx)(n.az,{paddingX:2,children:(0,f.jsx)(A,{board:e,currentView:t,onChange:r,viewer:u})}),a>=w.r$&&(0,f.jsxs)(o.Fragment,{children:[a>=w.N&&(0,f.jsx)(B,{component:13183,pinView:"board",viewType:5}),!i&&(0,f.jsx)(n.az,{paddingX:2,children:(0,f.jsx)(n.$n,{fullWidth:!0,onClick:s,text:c.bt("整理", "Organize", "The board organization button", undefined, true)})})]})]})}var D=i(924660),E=i(86527),M=i(497551),N=i(32712),O=i(894621),k=i(301704),R=i(310206),L=i(831064),H=i(59404),$=i(615838),F=i(385984),K=i(558836),W=i(973433),V=i(904396),U=i(812667),X=i(869488);function Y(e,t,i){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:o+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function G(e){let{allowReordering:t,board:i,canEdit:o,display:r,dragDrop:s,index:a,isDragging:l,oneTapMovePinsHandler:d,onShowEditSectionModal:c,organizeMode:u,section:h}=e,p=s&&s.target;return(0,f.jsx)(n.az,{height:"100%",children:(0,f.jsx)(V.e,{children:({focused:e,hovered:n,onBlur:s,onFocus:_,onMouseEnter:m,onMouseLeave:g})=>(0,f.jsx)(U.A,{allowReordering:t,board:i,boardSection:h,canEdit:o,display:r,focused:e,hovered:n,inOrganizationMode:u,isDragging:l,isMergeTarget:!!p&&"merge"===p.action&&a===p.index,onBlur:e=>{let{currentTarget:t}=e;setTimeout(()=>{t.contains(document.activeElement)||s()},0)},oneTapMovePinsHandler:d,onFocus:_,onMouseEnter:m,onMouseLeave:g,onShowEditSectionModal:c})})})}function J(e){let{allowReordering:t,board:i,canEdit:o,dragDrop:r,handleSectionDragBegin:s,handleSectionDragEnd:l,handleSectionDragHover:d,isDragging:u,isDragWithinBounds:h,oneTapMovePinsHandler:p,onShowEditSectionModal:_,organizeMode:m,sections:g}=e,{experimentalGutter:b}=(0,a.A)(),y=(0,c.WO)()?.boardPinDensity??"",v=(0,X.k4)(y);return(0,f.jsx)(W.default,{cacheKey:`board-boardsections:${i.id}`,columnWidth:v,gutterWidth:b,items:g,layout:"flexible",minCols:2,renderItem:({data:e,itemIdx:a})=>{let c=(0,f.jsx)(G,{allowReordering:t,board:i,canEdit:o,display:"responsive",dragDrop:r,index:a,isDragging:u,oneTapMovePinsHandler:p,onShowEditSectionModal:_,organizeMode:m,section:e});return(0,f.jsx)(n.az,{height:"100%",children:t?(0,f.jsx)($.A,{index:a,onDragBegin:s,onDragEnd:l,onDragHover:d,type:$.x.Section,children:(0,f.jsx)("div",{style:{opacity:u&&!h?.5:1},children:c})}):(0,f.jsx)(n.az,{height:"100%",children:c})},e.id)}})}class q extends o.Component{constructor(...e){super(...e),Y(this,"state",{dragDrop:null,sectionIds:this.props.sections.map(e=>e.id??"")}),Y(this,"cancelHoverTimeout",()=>{let{dragHoverTimeout:e}=this;e&&clearTimeout(e.timeoutId),this.dragHoverTimeout=null}),Y(this,"dragHoverTimeout",null),Y(this,"isDragging",()=>!!this.state.dragDrop),Y(this,"handleSectionDragBegin",e=>{this.setState({dragDrop:{previewIndex:e,sourceIndex:e,target:null}})}),Y(this,"handleSectionDragHover",(e,t)=>{var i;let{dragDrop:o}=this.state,n=this.props.allowReordering;if(!t||!o)return;let{previewIndex:r}=o,s=function({hoverRelativePosition:{positionRelativeToCenter:{x:e},boundingBox:{width:t}},centerEnabled:i}){return Math.abs(e)<(i?.5*t:0)/2?"center":e<0?"left":"right"}({hoverRelativePosition:t,centerEnabled:e!==r&&n}),a={itemIndex:e,regionWithinItem:s};if(this.dragHoverTimeout&&(i=this.dragHoverTimeout.hoverLocation,a.itemIndex===i.itemIndex&&a.regionWithinItem===i.regionWithinItem))return;this.cancelHoverTimeout();let l="center"===s?"merge":"reorder",d={action:l,index:function({hoverLocation:{itemIndex:e,regionWithinItem:t},sourceIndex:i}){if("center"===t||e===i)return e;let o="left"===t;return e<i===o?e:o?e-1:e+1}({hoverLocation:a,sourceIndex:r})};if(d.index===r){o.target&&o.target.index!==d.index&&this.setState({dragDrop:{...o,target:d}});return}this.dragHoverTimeout={hoverLocation:a,timeoutId:setTimeout(()=>{this.dragHoverTimeout=null,"reorder"===l?this.setState(({dragDrop:e,sectionIds:t})=>({dragDrop:{...e,target:d,previewIndex:d.index},sectionIds:(0,M.A)(t,r,d.index)})):this.setState(({dragDrop:e})=>({dragDrop:{...e,target:d}}))},"reorder"===l?200:20)}}),Y(this,"handleSectionDragEnd",e=>{let{sections:t,onShowMergeSectionsConfirmationModal:i,onSectionReorder:o}=this.props,{dragDrop:n,sectionIds:r}=this.state,s=n&&n.target;if(this.cancelHoverTimeout(),!e||!n||!s||s.index===n.sourceIndex)return void this.setState({dragDrop:null,sectionIds:t.map(e=>e.id??"")});let{previewIndex:a,sourceIndex:l}=n,{action:d,index:c}=s;if(this.setState({dragDrop:null}),"merge"===d){let e=e=>{let i=r[e];return i&&t.find(({id:e})=>e===i)},o=e(a),n=e(c);o&&n&&i(o,n)}else o(l,c)})}componentDidUpdate(e){let{sections:t}=e,{sections:i}=this.props,o=e=>e.map(({id:e})=>e).join(",");if(t.length!==i.length&&o(t)!==o(i)){this.cancelHoverTimeout();let e=i.map(e=>e.id??"");this.setState({dragDrop:null,sectionIds:e})}}componentWillUnmount(){this.cancelHoverTimeout()}render(){let{allowReordering:e,connectDropTarget:t,isDragWithinBounds:i,sections:o}=this.props,{sectionIds:r}=this.state,s=this.isDragging(),a=o.reduce((e,t)=>t.id?{...e,[t.id]:t}:e,{}),l=(0,f.jsx)(J,{allowReordering:e,board:this.props.board,canEdit:this.props.canEdit,dragDrop:this.state.dragDrop,handleSectionDragBegin:this.handleSectionDragBegin,handleSectionDragEnd:this.handleSectionDragEnd,handleSectionDragHover:this.handleSectionDragHover,isDragging:s,isDragWithinBounds:i??!1,oneTapMovePinsHandler:this.props.oneTapMovePinsHandler,onShowEditSectionModal:this.props.onShowEditSectionModal,organizeMode:this.props.organizeMode,sections:r.map(e=>a[e]).filter(e=>!!e)});return(0,f.jsxs)(n.az,{width:"100%",children:[e&&t?t((0,f.jsx)("div",{children:l})):l,s&&(0,f.jsx)(F.A,{})]})}}let Q=(0,K.A)($.x.Section)(q);function Z(e){(0,o.useEffect)(()=>{(0,h.A)("BoardSectionList","/app/www/save/board/BoardDefaultTabContent/BoardSectionList.tsx")},[]);let t=(0,p.A)(),{allowReordering:i,fetchMore:r,isAtEnd:s,isFetching:a}=e;return(0,f.jsxs)(n.az,{width:"100%",children:[(0,f.jsx)(n.WY,{fetchMore:r,isAtEnd:s,isFetching:a}),i?(0,f.jsx)(Q,{...e}):(0,f.jsx)(q,{...e}),a&&!s&&(0,f.jsx)(n.az,{paddingY:6,position:"relative",children:(0,f.jsx)(n.y$,{accessibilityLabel:t.bt("正在加载区块", "Loading sections", "loading state for board sections", undefined, true),show:!0})})]})}class ee extends o.Component{constructor(...e){var t,i,o;super(...e),t="handleSectionReorder",i=(e,t)=>{let{board:i,dispatch:o,enableReordering:n,sections:r,viewParameter:s}=this.props;if(!n)return;let a=r[e].id,l=r[t].id,d=(0,M.A)(r,e,t).map(e=>e.id),c=d.indexOf(a),u=e=>e>=0&&e<d.length,h={boardId:i.id,sourceSectionId:a,targetSectionId:l,...u(c+1)?{sectionIdAfter:d[c+1]}:{},...u(c-1)?{sectionIdBefore:d[c-1]}:{}},p={object_id_str:a,view_type:5,view_parameter:s};o(e=>{let{boardId:t,sectionIdBefore:i,sectionIdAfter:o,sourceSectionId:n,targetSectionId:r}=h;e((0,R.kl)({feedType:L.A.BOARD_SECTIONS,feedId:t,itemType:"boardsection",sourceItemId:n,targetItemId:r}));let s=Object.freeze({});return i&&(s={...s,section_before:i}),o&&(s={...s,section_after:o}),(0,k.A)({url:"/v3/board/sections/{section}/reorder/",urlParams:{section:n},method:"POST",data:s})}).then(()=>this.props.logContextEvent({event_type:7133,...p}))},(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:o+"")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidMount(){(0,h.A)("BoardSections","/app/www/save/board/BoardDefaultTabContent/BoardSections.tsx");let{sectionsInvalidated:e,onLoadedAll:t,sectionsResource:{isFetching:i,refresh:o,isAtEnd:n}}=this.props;e&&!i&&o(),n&&t()}componentDidUpdate(e){let{sectionsInvalidated:t,sectionsResource:i}=e,{sectionsInvalidated:o,isFetching:n,refreshData:r,sectionsResource:s}=this.props;!o||t||n||r(),!i.isAtEnd&&s.isAtEnd&&this.props.onLoadedAll()}render(){let{board:e,enableReordering:t,i18n:i,inBoardOrganizationMode:o,oneTapMovePinsHandler:r,onShowEditSectionModal:s,onShowMergeSectionsConfirmationModal:a,sections:l,sectionsResource:d,viewer:c,orbacActingAs:u}=this.props,{access:h,owner:p}=e,{isLoaded:_,isFetching:m,fetchMore:g,isAtEnd:b}=d;if(!_)return i.bt("图板区块加载图示", "Board sections loading spinner", "BoardPage.BoardSections.loadingSpinner", undefined, true),(0,f.jsx)(n.y$,{accessibilityLabel:i.bt("图板区块加载图示", "Board sections loading spinner", " - ", undefined, true),show:!0});let y=(h||[]).includes("write")||(0,O.Nn)(c,p?.id||"",u);return(0,f.jsx)(n.so,{alignItems:"stretch",justifyContent:"center",children:(0,f.jsx)(Z,{allowReordering:t,board:e,canEdit:y,fetchMore:g,isAtEnd:b,isFetching:m,oneTapMovePinsHandler:r,onSectionReorder:this.handleSectionReorder,onShowEditSectionModal:s,onShowMergeSectionsConfirmationModal:a,organizeMode:o,sections:l})})}}function et(e){let{logContextEvent:t}=(0,r.o)(),i=(0,p.A)(),o=(0,l.A)(),n=(0,N.A)(),s=(0,O.H7)(o,n),{board:a}=e,{id:d,privacy:c}=a,u=(0,P.A)({name:"BoardSectionsResource",options:{board_id:d,redux_normalize_feed:!0,...(0,E.A)(c)&&s?{orbac_subject_id:s}:{}}}),h=(0,D.d4)(e=>e.feeds[`${L.A.BOARD_SECTIONS}:${d}`]),_=(0,D.d4)(e=>(h||[]).reduce((t,i)=>"boardsection"===i.type&&e.boardsections[i.id]?t.concat([e.boardsections[i.id]]):t,[])),m=null===h,g=(0,D.wA)(),b=o.isAuth&&a.owner?.id===o.id||a.collaborated_by_me;return!(0,E.A)(c)||s||b?(0,f.jsx)(ee,{...e,dispatch:g,i18n:i,logContextEvent:t,orbacActingAs:n,sections:_,sectionsInvalidated:m,sectionsResource:u,viewer:o}):null}function ei(e){(0,o.useEffect)(()=>{(0,h.A)("BoardSections","/app/www/save/board/BoardDefaultTabContent/BoardSections.tsx")},[]);let t=(0,l.A)(),i=(0,N.A)(),{board:n,isBoardPreviewMode:r}=e,{access:s,featured_board_metadata:a,owner:d}=n||{},{has_expanded_sections:c}=a||{},u=(s||[]).includes("write")||(0,O.Nn)(t,d?.id||"",i);return c&&(!u||r)?(0,f.jsx)(H.A,{...e}):(0,f.jsx)(et,{...e})}var eo=i(874434),en=i(219093),er=i(512072),es=i(761756);function ea(e){let t=(0,l.A)(),i=(0,N.A)(),o=(0,O.H7)(t,i),{board:n,currentView:r,currentFilter:s,viewer:a}=e,d=(0,P.A)({name:"BoardFeedResource",options:(0,en.R)(n,a,r,s,o),noCache:n.owner.username===a.username||n.collaborated_by_me}),c=(0,D.d4)(({feeds:t,desktopStories:i})=>(0,es.A)(t[`${L.A.BOARDFEED}:${e.board.id}`],i));return(0,f.jsx)(er.A,{...e,...c,resource:d})}ea.displayName="BoardSectionlessPinGrid";var el=i(189862),ed=i(115188),ec=i(156100),eu=i(557364),eh=i(267980);function ep({actions:e,board:t,bulkEditSelectedPins:i,currentFilter:h,currentView:p,displayActionBar:_,enableReordering:m,inBoardOrganizationMode:g,inSectionOrganizationMode:b,inSelectAll:y,isBoardPreviewMode:v,isOwnBoard:x,isPinGridSorted:A,onBulkEditPinClick:P,onContentViewChange:j,oneTapMovePinsHandler:S,onShowEditSectionModal:z,onShowMergeSectionsConfirmationModal:I,refreshFilteredFeed:C,viewParameter:B}){let D=(0,u.oW)()(t.id),E=(D?D.section_count:t.section_count)||0,M=(0,c.WO)()?.boardPinDensity,{logContextEvent:N}=(0,r.o)(),[O,k]=(0,o.useState)(0===E),R=(0,s.A)(),L=(0,el.A)(t.url),H=(0,l.A)(),$=(0,d.Ay)(),{experimentalGutter:F}=(0,a.A)(),{is_collaborative:K,pin_count:W}=t,V=(t.access||[]).includes("write"),U=x||t.collaborated_by_me,X=!!("number"==typeof W&&W>=w.IT&&K&&U);return(0,f.jsxs)(n.az,{marginBottom:12,children:[(0,f.jsx)(eo.A,{setMaxWidth:!1,children:(0,f.jsxs)(n.az,{children:[E>0&&(!h||-1===h)&&(0,f.jsx)(ei,{board:t,enableReordering:m,inBoardOrganizationMode:!!g,isBoardPreviewMode:v,oneTapMovePinsHandler:S,onLoadedAll:()=>k(!0),onShowEditSectionModal:z,onShowMergeSectionsConfirmationModal:I,viewParameter:B}),_&&O&&U&&E>0&&(0,f.jsx)(T,{board:t,currentView:p,inBoardOrganizationMode:g,onContentViewChange:j,onOrganizeClick:()=>{if(R)return void R();let{onBoardOrganizeClick:t}=e;N({event_type:101,component:69,element:400,view_type:5}),t&&t(!0)},pinCount:W??0,showSortOptions:X})]})}),"desktop"===$&&O&&(0,f.jsx)(n.az,{dangerouslySetInlineStyle:{__style:{paddingBottom:"8px"}},"data-test-id":"board-feed",paddingX:0,position:"relative",children:(0,f.jsx)(ea,{board:t,bulkEditSelectedPins:i,currentFilter:h,currentView:p,denseViewSelected:V&&"dense"===M,inBoardOrganizationMode:g,inSectionOrganizationMode:b,inSelectAll:y,isOwnBoard:x,isPinGridSorted:A,onBulkEditPinClick:P,refreshFilteredFeed:C,renderBoardShopModule:(e,t=!1)=>(0,f.jsx)(n.az,{dangerouslySetInlineStyle:{__style:F?{paddingLeft:F,paddingRight:F}:{}},marginBottom:6,children:(0,f.jsx)(ed.A,{isTopVariant:t,storyId:e})}),renderFeaturedBoardsStory:e=>(0,f.jsx)(n.az,{marginBottom:6,children:(0,f.jsx)(ec.A,{isOwnBoard:x,storyId:e})}),renderFooterStory:e=>g||t.archived_by_me_at||!U?null:(0,f.jsx)(n.az,{marginBottom:6,children:(0,f.jsx)(eo.A,{children:(0,f.jsx)(eh.A,{collection:t,storyId:e,url:L})})}),renderMoreIdeas:e=>U?null:(0,f.jsx)(n.az,{marginBottom:6,children:(0,f.jsx)(eu.default,{storyId:e})}),viewer:H,viewParameter:B})})]})}},655471(e,t,i){i.d(t,{A:()=>u});var o=i(657140),n=i(924660),r=i(129625),s=i(268989),a=i(972955),l=i(396901),d=i(723029),c=i(931510);function u({board:e}){let{logContextEvent:t}=(0,r.o)(),i=(0,l.A)(),[u,h]=(0,o.useState)(null),p=(0,n.wA)(),{showBlockingActionToast:_}=(0,d.A)(),m=(0,s.A)();return{handleShowMergeSectionsConfirmationModal:(e,t)=>{m?m():h({source:e,target:t})},mergeConfirmationModalProps:u,onConfirm:()=>{if(m)return void m();if(!u)return;let{source:o,target:n}=u;h(null),t({event_type:7173,object_id_str:o.id,aux_data:{merge_flow:"dnd"}}),p((0,c.A)(e.id,o.id??"",n.id??"")).then(()=>{_({actionType:"merge",board:e,section:n})}).catch(e=>{a.A.showError(e.message||i.bt("无法合并图板区块", "Failed to merge sections", "useSectionMergeAction.errorMessage", undefined, true))})}}}},219093(e,t,i){i.d(t,{R:()=>o});function o(e,t,i,o,n){let{owner:r}=e,s=r?.id===t.id,a="react_grid_pin";return t.isPartner&&s&&(a="partner_react_grid_pin"),{board_id:e.id,board_url:e.url??"",currentFilter:o,field_set_key:a,filter_section_pins:!o||-1===o,sort:"most_reactions"===i?"most_reactions":"default",layout:e.layout??"",page_size:25,redux_normalize_feed:!0,...n?{orbac_subject_id:n}:Object.freeze({})}}},874434(e,t,i){i.d(t,{A:()=>a});var o=i(335831),n=i(657140),r=i(836737),s=i(135656);function a({children:e,setMaxWidth:t=!0}){return(0,n.useEffect)(()=>{(0,o.A)("BoardPageLayoutWrap","/app/www/save/board/BoardPageLayoutWrap.tsx")},[]),(0,s.jsx)(r.so,{alignItems:"stretch",justifyContent:"center",width:"100%",children:t?(0,s.jsx)(r.az,{maxWidth:774,paddingX:2,width:"100%",children:e}):(0,s.jsx)(r.az,{width:"100%",children:e})})}},812667(e,t,i){i.d(t,{A:()=>w});var o=i(335831),n=i(657140),r=i(836737),s=i(86527),a=i(47998),l=i(396901),d=i(32712),c=i(894621),u=i(242595),h=i(616275),p=i(135656);let _=e=>{(0,n.useEffect)(()=>{(0,o.A)("OneTapMovePill","/app/www/save/board/BoardSectionCard/OneTapMovePill.tsx")},[]);let t=(0,l.A)(),{numberOfSelectedPins:i}=e;return(0,p.jsx)(r.az,{alignItems:"center",bottom:!0,display:"flex",justifyContent:"center",left:!0,position:"absolute",right:!0,top:!0,children:(0,p.jsx)(r.az,{color:"default",padding:3,rounding:"pill",children:(0,p.jsx)(r.KJ,{weight:"bold",children:(0,h.A)(t.nbt(["将 {{ count }} 张 Pin 图移动到这里"], i, "Call to action overlay on a section to move selected Pins", true),{count:i})})})})};var m=i(869488);function g({display:e,isHovered:t,mode:i,pins:s}){(0,n.useEffect)(()=>{(0,o.A)("SectionPreviewPinList","/app/www/save/board/BoardSectionCard/SectionPreviewPinList.tsx")},[]);let a=(0,m.nc)(i),l="dense"===i,d=l?m.$_.compact:m.$_.wide,c=l?m.m.compact:m.m.wide,u=(0,m.k4)(i),h=Array.from(Array(a),(t,i)=>{let o=i===a-1,{description:n,image_large_url:l,image_large_size_pixels:h,image_medium_url:_,image_medium_size_pixels:m}=s[i]||{},g=n?n.trim():"",f=_??l;return(0,p.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{paddingRight:o?void 0:1}},"data-test-id":g?"pin-with-alt-text":"pin-missing-alt-text",width:"responsive"===e?`${c/u*100}%`:c,children:(0,p.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{paddingBottom:`${d/c*100}%`}},overflow:"hidden",position:"relative",width:"100%",children:(0,p.jsx)(r.az,{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:(0,p.jsx)(r.n1,{height:"responsive"===e?"100%":d,rounding:0,wash:!0,width:"responsive"===e?"100%":c,children:h&&f&&(0,p.jsx)(r._V,{alt:"",color:"transparent",fit:"cover",naturalHeight:(m?m.height:h.height)??1,naturalWidth:(m?m.width:h.width)??1,src:f})})})})},i)});return(0,p.jsx)(r.n1,{rounding:400,width:"responsive"===e?"100%":u,children:(0,p.jsxs)(r.so,{alignItems:"stretch",justifyContent:"start",children:[(0,p.jsx)(r.az,{bottom:!0,dangerouslySetInlineStyle:{__style:t?{zIndex:1,backgroundColor:"rgba(0,0,0,0.06)"}:{}},left:!0,position:"absolute",right:!0,top:!0}),h]})})}var f=i(376195),b=i(51968),y=i(410899);let v=({count:e,size:t})=>{(0,n.useEffect)(()=>{(0,o.A)("CountTexts","/app/www/save/board/CountTexts.tsx")},[]);let i=(0,l.A)(),{locale:s}=(0,f._8)(),a=(0,b.A)(),d=(0,y.vQ)(i.nbt(["{{ count }} 张 Pin 图"], e, "profile.ProfilePage.board.BoardCard.PinsCount", true),{count:a(s,e,{})});return(0,p.jsx)(r.az,{children:(0,p.jsx)(r.KJ,{color:"default",inline:!0,size:t,children:d})})};function x({children:e,mode:t}){return(0,p.jsx)(r._Y,{accessibilityLevel:2,lineClamp:"dense"===t?void 0:1,size:"dense"===t?"300":"400",children:e})}function A({children:e,display:t,displayEditIcon:i,href:s,mode:a,mouseCursor:d,onEditClick:c,onTouch:u,pinCount:h,title:_}){(0,n.useEffect)(()=>{(0,o.A)("SectionRep","/app/www/save/board/BoardSectionCard/SectionRep.tsx")},[]);let g=(0,l.A)(),{isRTL:b}=(0,f._8)(),y=(0,p.jsxs)(r.az,{position:"relative",width:"responsive"===t?"100%":(0,m.k4)(a),children:[e,(0,p.jsx)(r.so,{alignItems:"start",justifyContent:"between",width:"100%",children:(0,p.jsxs)(r.az,{flex:"grow",padding:2,children:[(0,p.jsx)(x,{mode:a,children:_}),(0,p.jsx)(r.az,{marginTop:1,children:(0,p.jsx)(v,{count:h,size:"100"})})]})}),s&&(0,p.jsx)(r.az,{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:(0,p.jsx)(r.$A,{fullHeight:!0,fullWidth:!0,href:s,rounding:200,children:(0,p.jsx)(r.az,{display:"visuallyHidden",height:"100%",width:"100%",children:g.bt("查看 Pin 图", "See Pins", "BoardSectionCard.SectionRep.accessibilityTextLink", undefined, true)})})}),i&&(0,p.jsx)(r.az,{bottom:!0,left:b,marginBottom:15,padding:2,position:"absolute",right:!b,children:(0,p.jsx)(r.K0,{accessibilityHaspopup:!0,accessibilityLabel:g.bt("编辑", "Edit", "BoardSectionCard.SectionRep.EditIcon", undefined, true),bgColor:"default",icon:"pencil",iconColor:"default",onClick:c,size:"sm"})})]});return u?(0,p.jsx)(r.Rp,{fullWidth:"responsive"===t,mouseCursor:d,onTap:u,rounding:400,children:y}):y}let w=e=>{let t;(0,n.useEffect)(()=>{(0,o.A)("BoardSectionCard","/app/www/save/board/BoardSectionCard/BoardSectionCard.tsx")},[]);let{board:i,boardSection:h,canEdit:m,display:f,focused:b,hovered:y,inCollageCreation:v,inOrganizationMode:x,isDragging:w,isMergeTarget:P,onBlur:j,oneTapMovePinsHandler:S,onFocus:z,onMouseEnter:I,onMouseLeave:C,onShowEditSectionModal:B}=e,T=(0,l.A)(),D=(0,a.A)(),E=(0,d.A)(),M=(0,c.H7)(D,E),N=M&&(0,s.A)(i.privacy)?`?orbac_subject_id=${M}`:"",{slug:O,title:k,preview_pins:R=[]}=h,L=(0,u.WO)()?.boardPinDensity??"",H=S&&S.numberOfSelectedPins;H&&S&&(t=()=>{S.moveToSection(h)});let $="pointer";w?$="grabbing":!H&&x&&($="grab");let F=!!m&&!w&&(y||b),K=S&&S.numberOfSelectedPins>0&&!!H&&y&&!w&&(0,p.jsx)(_,{numberOfSelectedPins:S.numberOfSelectedPins});return(0,p.jsx)(r.az,{"aria-label":T.bt("图板区块", "Board section", "BoardSectionCard.ariaLabel", undefined, true),"data-test-id":`section-${h.title??""}`,onBlur:j,onFocus:z,onMouseEnter:I,onMouseLeave:C,role:"group",children:(0,p.jsx)(A,{display:f,displayEditIcon:F,href:x||v?void 0:`${i.url??""}${O??""}/${N}`,mode:L,mouseCursor:$,onEditClick:({event:e})=>{e.stopPropagation(),e.preventDefault(),B(h)},onTouch:t,pinCount:h.pin_count??0,title:k??"",children:(0,p.jsxs)(r.az,{position:"relative",children:[(0,p.jsx)(g,{display:f,isHovered:y||P||b,mode:L,pins:R??[]}),K]})})})}},869488(e,t,i){i.d(t,{$_:()=>o,k4:()=>s,m:()=>n,nc:()=>r});let o={compact:157,wide:141},n={compact:118,wide:106};function r(e){return"dense"===e?2:3}function s(e){return(("dense"===e?n.compact:n.wide)+1)*r(e)-1}},189862(e,t,i){i.d(t,{A:()=>o});function o(e=""){return`${e}_tools/more-ideas/`}},267980(e,t,i){i.d(t,{A:()=>f});var o,n=i(335831),r=i(657140),s=i(924660);i(654798);var a=i(836737),l=i(129625),d=i(900565),c=i(396901),u=i(619307),h=i(487044),p=i(135656);let _=(void 0!==o||(o=i(410727)).hash&&"f6776ff7c6fc3ce9a1f4b72a5dbaa0c2"!==o.hash&&console.error("The definition of 'MoreIdeasPreviewStory_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function m({pin:e}){return(0,p.jsx)(a.n1,{rounding:400,width:138,children:(0,p.jsx)(h.A,{height:207,pin:e&&"Pin"===e.__typename?{imageUrl:e.images_474x?.url??"",dominantColor:e.dominantColor??"",description:e.description??""}:null,width:138})})}function g({collection:e,storyKey:t,url:i}){(0,r.useEffect)(()=>{(0,n.A)("MoreIdeasPreviewStory","/app/www/save/board/MoreIdeasPreviewStory/MoreIdeasPreviewStory.tsx")},[]);let{logContextEvent:o}=(0,l.o)(),s=(0,c.A)(),{isHovering:h,hoverHandlers:g}=(0,u.A)(),f=(0,d.A)(_,t);if(!f)return null;let b=f.objects&&f.objects.filter(e=>"Pin"===e.__typename&&"pin"===e.type)||[];return(0,p.jsx)("div",{className:"moreIdeasOnBoard",children:(0,p.jsx)(a.$A,{fullWidth:!1,href:`${i}?ideas_referrer=${f.referringSource??""}`,onMouseEnter:g.onMouseOver,onMouseLeave:g.onMouseLeave,onTap:()=>o({event_type:101,element:10600,view_type:"boardsection"===e.type?164:5,object_id_str:e.id,view_parameter:3069}),rounding:400,children:(0,p.jsxs)(a.az,{alignItems:"start",color:h?"secondary":"default",direction:"column",display:"flex",justifyContent:"start",marginEnd:-3,paddingX:3,paddingY:2,rounding:400,width:"100%",children:[(0,p.jsx)(a.az,{padding:2,children:(0,p.jsx)(a._Y,{lineClamp:1,size:"400",children:"boardsection"===e.type?s.bt("为此区块寻找一些点子：", "Find some ideas for this section:", "Call-to-action text that upsells more ideas tab for an empty section", undefined, true):s.bt("为此图板寻找一些点子：", "Find some ideas for this board:", "Call-to-action text that upsells more ideas tab for an empty board", undefined, true)})}),(0,p.jsx)(a.az,{display:"flex",justifyContent:"between",padding:2,role:"list",width:"100%",children:[...[,,,,,].keys()].map(e=>{let t=b[e],i=t&&"Pin"===t.__typename&&t.description?t.description.trim():"";return(0,p.jsx)(a.az,{"data-test-id":i?"pin-with-alt-text":"pin-missing-alt-text",role:"listitem",children:(0,p.jsx)(m,{pin:t})},`${t&&"Pin"===t.__typename&&t.entityId?t.entityId:e}`)})})]})})})}function f(e){(0,r.useEffect)(()=>{(0,n.A)("MoreIdeasPreviewStory","/app/www/save/board/MoreIdeasPreviewStory/MoreIdeasPreviewStory.tsx")},[]);let t=(0,s.d4)(t=>t.desktopStories[e.storyId]),i="board_ideas_preview_detailed"===t.story_type?t:void 0;return(0,p.jsx)(g,{...e,storyKey:void 0!==i?{type:"Legacy",data:i}:null})}},487044(e,t,i){i.d(t,{A:()=>c});var o=i(335831),n=i(657140),r=i(836737),s=i(396901),a=i(616275),l=i(135656);function d({pinCount:e,height:t,size:i}){let o=(0,s.A)(),n=(0,a.A)(o.bt("+{{ pinCount }}", "+{{ pinCount }}", "+N count overlay on pin selections", undefined, true),{pinCount:e});return(0,l.jsx)(r.az,{alignItems:"center",dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0,0,0,.2)"}},display:"flex",height:t,justifyContent:"center",children:"sm"===i?(0,l.jsx)(r.KJ,{color:"light",size:"200",weight:"bold",children:n}):(0,l.jsx)(r._Y,{color:"light",size:"600",children:n})})}function c({additionalPinCount:e,additionalPinCountSize:t="lg",pin:i,width:s,height:a,rounded:c}){return(0,n.useEffect)(()=>{(0,o.A)("PreviewPin","/app/www/save/board/PreviewPin/PreviewPin.tsx")},[]),(0,l.jsx)(r.n1,{height:a,rounding:400*!!c,wash:!0,width:s,children:i&&(0,l.jsx)(r._V,{alt:i.description,color:i.dominantColor,fit:"cover",naturalHeight:a,naturalWidth:s,src:i.imageUrl,children:!!e&&(0,l.jsx)(d,{height:a,pinCount:e,size:t})})})}},593347(e,t,i){i.d(t,{A:()=>s});var o=i(221718),n=i(424120);let r=Object.freeze({});function s(e,t){let i=n.Ay.getItem(o.OR)||r;return(e.isAuth&&i[e.id]||{})[t.id]||null}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/19414.zh_CN-89b08bafd05d0efa.mjs.map